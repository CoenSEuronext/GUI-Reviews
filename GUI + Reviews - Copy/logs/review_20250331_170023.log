2025-03-31 17:00:23,292 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 17:00:23,294 - werkzeug - INFO -  * Debugger PIN: 691-175-853
2025-03-31 17:00:27,382 - Review.reviews.wifrp_review - INFO - Loading EOD data...
2025-03-31 17:00:29,791 - Review.reviews.wifrp_review - INFO - Loading reference data...
2025-03-31 17:00:37,984 - Review.reviews.wifrp_review - INFO - Filtering universe to exclude Euronext Paris (XPAR) listings...
2025-03-31 17:00:37,986 - Review.reviews.wifrp_review - INFO - Adding Free Float data...
2025-03-31 17:00:37,989 - Review.reviews.wifrp_review - INFO - Applying exclusion criteria...
2025-03-31 17:00:38,025 - Review.reviews.wifrp_review - WARNING - Removed 9316 duplicate rows from ICB data
2025-03-31 17:00:38,025 - Review.reviews.wifrp_review - INFO - Merging ICB data with 'Supersector Code' column
2025-03-31 17:00:38,045 - Review.reviews.wifrp_review - INFO - Processing sector: 1010.0, region: AS, group size: 46
2025-03-31 17:00:38,046 - Review.reviews.wifrp_review - INFO - Companies in group: 46, to exclude: 9
2025-03-31 17:00:38,047 - Review.reviews.wifrp_review - INFO - Processing sector: 1010.0, region: EU, group size: 20
2025-03-31 17:00:38,047 - Review.reviews.wifrp_review - INFO - Companies in group: 20, to exclude: 3
2025-03-31 17:00:38,048 - Review.reviews.wifrp_review - INFO - Processing sector: 1010.0, region: NA, group size: 83
2025-03-31 17:00:38,048 - Review.reviews.wifrp_review - INFO - Companies in group: 83, to exclude: 16
2025-03-31 17:00:38,049 - Review.reviews.wifrp_review - INFO - Processing sector: 1510.0, region: AS, group size: 12
2025-03-31 17:00:38,049 - Review.reviews.wifrp_review - INFO - Companies in group: 12, to exclude: 2
2025-03-31 17:00:38,049 - Review.reviews.wifrp_review - INFO - Processing sector: 1510.0, region: EU, group size: 18
2025-03-31 17:00:38,050 - Review.reviews.wifrp_review - INFO - Companies in group: 18, to exclude: 3
2025-03-31 17:00:38,050 - Review.reviews.wifrp_review - INFO - Processing sector: 1510.0, region: NA, group size: 10
2025-03-31 17:00:38,051 - Review.reviews.wifrp_review - INFO - Companies in group: 10, to exclude: 1
2025-03-31 17:00:38,051 - Review.reviews.wifrp_review - INFO - Processing sector: 2010.0, region: AS, group size: 30
2025-03-31 17:00:38,051 - Review.reviews.wifrp_review - INFO - Companies in group: 30, to exclude: 5
2025-03-31 17:00:38,052 - Review.reviews.wifrp_review - INFO - Processing sector: 2010.0, region: EU, group size: 42
2025-03-31 17:00:38,052 - Review.reviews.wifrp_review - INFO - Companies in group: 42, to exclude: 8
2025-03-31 17:00:38,052 - Review.reviews.wifrp_review - INFO - Processing sector: 2010.0, region: NA, group size: 46
2025-03-31 17:00:38,053 - Review.reviews.wifrp_review - INFO - Companies in group: 46, to exclude: 9
2025-03-31 17:00:38,053 - Review.reviews.wifrp_review - INFO - Processing sector: 3010.0, region: AS, group size: 30
2025-03-31 17:00:38,053 - Review.reviews.wifrp_review - INFO - Companies in group: 30, to exclude: 5
2025-03-31 17:00:38,054 - Review.reviews.wifrp_review - INFO - Processing sector: 3010.0, region: EU, group size: 43
2025-03-31 17:00:38,054 - Review.reviews.wifrp_review - INFO - Companies in group: 43, to exclude: 8
2025-03-31 17:00:38,054 - Review.reviews.wifrp_review - INFO - Processing sector: 3010.0, region: NA, group size: 21
2025-03-31 17:00:38,055 - Review.reviews.wifrp_review - INFO - Companies in group: 21, to exclude: 4
2025-03-31 17:00:38,055 - Review.reviews.wifrp_review - INFO - Processing sector: 3020.0, region: AS, group size: 17
2025-03-31 17:00:38,055 - Review.reviews.wifrp_review - INFO - Companies in group: 17, to exclude: 3
2025-03-31 17:00:38,056 - Review.reviews.wifrp_review - INFO - Processing sector: 3020.0, region: EU, group size: 31
2025-03-31 17:00:38,056 - Review.reviews.wifrp_review - INFO - Companies in group: 31, to exclude: 6
2025-03-31 17:00:38,056 - Review.reviews.wifrp_review - INFO - Processing sector: 3020.0, region: NA, group size: 32
2025-03-31 17:00:38,056 - Review.reviews.wifrp_review - INFO - Companies in group: 32, to exclude: 6
2025-03-31 17:00:38,057 - Review.reviews.wifrp_review - INFO - Processing sector: 3030.0, region: AS, group size: 13
2025-03-31 17:00:38,057 - Review.reviews.wifrp_review - INFO - Companies in group: 13, to exclude: 2
2025-03-31 17:00:38,057 - Review.reviews.wifrp_review - INFO - Processing sector: 3030.0, region: EU, group size: 30
2025-03-31 17:00:38,058 - Review.reviews.wifrp_review - INFO - Companies in group: 30, to exclude: 5
2025-03-31 17:00:38,058 - Review.reviews.wifrp_review - INFO - Processing sector: 3030.0, region: NA, group size: 23
2025-03-31 17:00:38,058 - Review.reviews.wifrp_review - INFO - Companies in group: 23, to exclude: 4
2025-03-31 17:00:38,059 - Review.reviews.wifrp_review - INFO - Processing sector: 3510.0, region: AS, group size: 48
2025-03-31 17:00:38,059 - Review.reviews.wifrp_review - INFO - Companies in group: 48, to exclude: 9
2025-03-31 17:00:38,059 - Review.reviews.wifrp_review - INFO - Processing sector: 3510.0, region: EU, group size: 21
2025-03-31 17:00:38,059 - Review.reviews.wifrp_review - INFO - Companies in group: 21, to exclude: 4
2025-03-31 17:00:38,060 - Review.reviews.wifrp_review - INFO - Processing sector: 3510.0, region: NA, group size: 22
2025-03-31 17:00:38,060 - Review.reviews.wifrp_review - INFO - Companies in group: 22, to exclude: 4
2025-03-31 17:00:38,060 - Review.reviews.wifrp_review - INFO - Processing sector: 4010.0, region: AS, group size: 15
2025-03-31 17:00:38,060 - Review.reviews.wifrp_review - INFO - Companies in group: 15, to exclude: 2
2025-03-31 17:00:38,061 - Review.reviews.wifrp_review - INFO - Processing sector: 4010.0, region: EU, group size: 10
2025-03-31 17:00:38,061 - Review.reviews.wifrp_review - INFO - Companies in group: 10, to exclude: 1
2025-03-31 17:00:38,061 - Review.reviews.wifrp_review - INFO - Processing sector: 4010.0, region: NA, group size: 4
2025-03-31 17:00:38,063 - Review.reviews.wifrp_review - INFO - Companies in group: 4, to exclude: 0
2025-03-31 17:00:38,063 - Review.reviews.wifrp_review - WARNING - No companies to exclude for sector 4010.0 and region NA
2025-03-31 17:00:38,063 - Review.reviews.wifrp_review - INFO - Processing sector: 4020.0, region: AS, group size: 29
2025-03-31 17:00:38,064 - Review.reviews.wifrp_review - INFO - Companies in group: 29, to exclude: 5
2025-03-31 17:00:38,064 - Review.reviews.wifrp_review - INFO - Processing sector: 4020.0, region: EU, group size: 21
2025-03-31 17:00:38,065 - Review.reviews.wifrp_review - INFO - Companies in group: 21, to exclude: 4
2025-03-31 17:00:38,065 - Review.reviews.wifrp_review - INFO - Processing sector: 4020.0, region: NA, group size: 17
2025-03-31 17:00:38,066 - Review.reviews.wifrp_review - INFO - Companies in group: 17, to exclude: 3
2025-03-31 17:00:38,066 - Review.reviews.wifrp_review - INFO - Processing sector: 4030.0, region: AS, group size: 6
2025-03-31 17:00:38,067 - Review.reviews.wifrp_review - INFO - Companies in group: 6, to exclude: 1
2025-03-31 17:00:38,067 - Review.reviews.wifrp_review - INFO - Processing sector: 4030.0, region: EU, group size: 8
2025-03-31 17:00:38,067 - Review.reviews.wifrp_review - INFO - Companies in group: 8, to exclude: 1
2025-03-31 17:00:38,068 - Review.reviews.wifrp_review - INFO - Processing sector: 4030.0, region: NA, group size: 6
2025-03-31 17:00:38,068 - Review.reviews.wifrp_review - INFO - Companies in group: 6, to exclude: 1
2025-03-31 17:00:38,069 - Review.reviews.wifrp_review - INFO - Processing sector: 4040.0, region: AS, group size: 13
2025-03-31 17:00:38,069 - Review.reviews.wifrp_review - INFO - Companies in group: 13, to exclude: 2
2025-03-31 17:00:38,070 - Review.reviews.wifrp_review - INFO - Processing sector: 4040.0, region: EU, group size: 10
2025-03-31 17:00:38,070 - Review.reviews.wifrp_review - INFO - Companies in group: 10, to exclude: 1
2025-03-31 17:00:38,070 - Review.reviews.wifrp_review - INFO - Processing sector: 4040.0, region: NA, group size: 20
2025-03-31 17:00:38,071 - Review.reviews.wifrp_review - INFO - Companies in group: 20, to exclude: 3
2025-03-31 17:00:38,071 - Review.reviews.wifrp_review - INFO - Processing sector: 4050.0, region: AS, group size: 19
2025-03-31 17:00:38,072 - Review.reviews.wifrp_review - INFO - Companies in group: 19, to exclude: 3
2025-03-31 17:00:38,072 - Review.reviews.wifrp_review - INFO - Processing sector: 4050.0, region: EU, group size: 10
2025-03-31 17:00:38,072 - Review.reviews.wifrp_review - INFO - Companies in group: 10, to exclude: 1
2025-03-31 17:00:38,073 - Review.reviews.wifrp_review - INFO - Processing sector: 4050.0, region: NA, group size: 19
2025-03-31 17:00:38,073 - Review.reviews.wifrp_review - INFO - Companies in group: 19, to exclude: 3
2025-03-31 17:00:38,073 - Review.reviews.wifrp_review - INFO - Processing sector: 4510.0, region: AS, group size: 25
2025-03-31 17:00:38,074 - Review.reviews.wifrp_review - INFO - Companies in group: 25, to exclude: 4
2025-03-31 17:00:38,074 - Review.reviews.wifrp_review - INFO - Processing sector: 4510.0, region: EU, group size: 24
2025-03-31 17:00:38,075 - Review.reviews.wifrp_review - INFO - Companies in group: 24, to exclude: 4
2025-03-31 17:00:38,075 - Review.reviews.wifrp_review - INFO - Processing sector: 4510.0, region: NA, group size: 17
2025-03-31 17:00:38,075 - Review.reviews.wifrp_review - INFO - Companies in group: 17, to exclude: 3
2025-03-31 17:00:38,076 - Review.reviews.wifrp_review - INFO - Processing sector: 4520.0, region: AS, group size: 16
2025-03-31 17:00:38,076 - Review.reviews.wifrp_review - INFO - Companies in group: 16, to exclude: 3
2025-03-31 17:00:38,076 - Review.reviews.wifrp_review - INFO - Processing sector: 4520.0, region: EU, group size: 11
2025-03-31 17:00:38,077 - Review.reviews.wifrp_review - INFO - Companies in group: 11, to exclude: 2
2025-03-31 17:00:38,077 - Review.reviews.wifrp_review - INFO - Processing sector: 4520.0, region: NA, group size: 12
2025-03-31 17:00:38,078 - Review.reviews.wifrp_review - INFO - Companies in group: 12, to exclude: 2
2025-03-31 17:00:38,078 - Review.reviews.wifrp_review - INFO - Processing sector: 5010.0, region: AS, group size: 17
2025-03-31 17:00:38,078 - Review.reviews.wifrp_review - INFO - Companies in group: 17, to exclude: 3
2025-03-31 17:00:38,079 - Review.reviews.wifrp_review - INFO - Processing sector: 5010.0, region: EU, group size: 22
2025-03-31 17:00:38,079 - Review.reviews.wifrp_review - INFO - Companies in group: 22, to exclude: 4
2025-03-31 17:00:38,080 - Review.reviews.wifrp_review - INFO - Processing sector: 5010.0, region: NA, group size: 10
2025-03-31 17:00:38,080 - Review.reviews.wifrp_review - INFO - Companies in group: 10, to exclude: 1
2025-03-31 17:00:38,080 - Review.reviews.wifrp_review - INFO - Processing sector: 5020.0, region: AS, group size: 95
2025-03-31 17:00:38,081 - Review.reviews.wifrp_review - INFO - Companies in group: 95, to exclude: 18
2025-03-31 17:00:38,081 - Review.reviews.wifrp_review - INFO - Processing sector: 5020.0, region: EU, group size: 81
2025-03-31 17:00:38,082 - Review.reviews.wifrp_review - INFO - Companies in group: 81, to exclude: 16
2025-03-31 17:00:38,082 - Review.reviews.wifrp_review - INFO - Processing sector: 5020.0, region: NA, group size: 75
2025-03-31 17:00:38,083 - Review.reviews.wifrp_review - INFO - Companies in group: 75, to exclude: 14
2025-03-31 17:00:38,083 - Review.reviews.wifrp_review - INFO - Processing sector: 5510.0, region: AS, group size: 20
2025-03-31 17:00:38,084 - Review.reviews.wifrp_review - INFO - Companies in group: 20, to exclude: 3
2025-03-31 17:00:38,084 - Review.reviews.wifrp_review - INFO - Processing sector: 5510.0, region: EU, group size: 16
2025-03-31 17:00:38,084 - Review.reviews.wifrp_review - INFO - Companies in group: 16, to exclude: 3
2025-03-31 17:00:38,085 - Review.reviews.wifrp_review - INFO - Processing sector: 5510.0, region: NA, group size: 12
2025-03-31 17:00:38,085 - Review.reviews.wifrp_review - INFO - Companies in group: 12, to exclude: 2
2025-03-31 17:00:38,086 - Review.reviews.wifrp_review - INFO - Processing sector: 5520.0, region: AS, group size: 17
2025-03-31 17:00:38,086 - Review.reviews.wifrp_review - INFO - Companies in group: 17, to exclude: 3
2025-03-31 17:00:38,086 - Review.reviews.wifrp_review - INFO - Processing sector: 5520.0, region: EU, group size: 17
2025-03-31 17:00:38,087 - Review.reviews.wifrp_review - INFO - Companies in group: 17, to exclude: 3
2025-03-31 17:00:38,087 - Review.reviews.wifrp_review - INFO - Processing sector: 5520.0, region: NA, group size: 6
2025-03-31 17:00:38,088 - Review.reviews.wifrp_review - INFO - Companies in group: 6, to exclude: 1
2025-03-31 17:00:38,088 - Review.reviews.wifrp_review - INFO - Processing sector: 6010.0, region: AS, group size: 10
2025-03-31 17:00:38,088 - Review.reviews.wifrp_review - INFO - Companies in group: 10, to exclude: 1
2025-03-31 17:00:38,089 - Review.reviews.wifrp_review - INFO - Processing sector: 6010.0, region: EU, group size: 17
2025-03-31 17:00:38,089 - Review.reviews.wifrp_review - INFO - Companies in group: 17, to exclude: 3
2025-03-31 17:00:38,089 - Review.reviews.wifrp_review - INFO - Processing sector: 6010.0, region: NA, group size: 34
2025-03-31 17:00:38,090 - Review.reviews.wifrp_review - INFO - Companies in group: 34, to exclude: 6
2025-03-31 17:00:38,090 - Review.reviews.wifrp_review - INFO - Processing sector: 6510.0, region: AS, group size: 22
2025-03-31 17:00:38,091 - Review.reviews.wifrp_review - INFO - Companies in group: 22, to exclude: 4
2025-03-31 17:00:38,091 - Review.reviews.wifrp_review - INFO - Processing sector: 6510.0, region: EU, group size: 23
2025-03-31 17:00:38,091 - Review.reviews.wifrp_review - INFO - Companies in group: 23, to exclude: 4
2025-03-31 17:00:38,092 - Review.reviews.wifrp_review - INFO - Processing sector: 6510.0, region: NA, group size: 31
2025-03-31 17:00:38,092 - Review.reviews.wifrp_review - INFO - Companies in group: 31, to exclude: 6
2025-03-31 17:00:38,093 - Review.reviews.wifrp_review - INFO - Calculating FFMC for all companies in universe...
2025-03-31 17:00:38,093 - Review.reviews.wifrp_review - WARNING - Column 'Price (EUR)' not found in universe_df
2025-03-31 17:00:38,094 - Review.reviews.wifrp_review - INFO - Found similar price columns: ['Price (EUR) ', 'Mcap in EUR']
2025-03-31 17:00:38,094 - Review.reviews.wifrp_review - INFO - Using 'Mcap in EUR' to calculate price
2025-03-31 17:00:38,095 - Review.reviews.wifrp_review - ERROR - Error during review calculation: 'FFMC'
2025-03-31 17:00:38,101 - Review.reviews.wifrp_review - ERROR - Traceback (most recent call last):
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'FFMC'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\Review\reviews\wifrp_review.py", line 494, in run_wifrp_review
    universe_df['Rank'] = universe_df['FFMC'].rank(ascending=False, method='min')
                          ~~~~~~~~~~~^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'FFMC'

2025-03-31 17:00:38,133 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 17:00:38] "POST /calculate HTTP/1.1" 200 -
2025-03-31 17:01:48,548 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\OneDrive - Euronext\\Documents\\Projects\\GUI + Reviews\\Review\\reviews\\wifrp_review.py', reloading
2025-03-31 17:01:48,551 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\OneDrive - Euronext\\Documents\\Projects\\GUI + Reviews\\Review\\reviews\\wifrp_review.py', reloading
