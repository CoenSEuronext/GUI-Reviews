2025-09-15 17:52:16,646 - werkzeug - WARNING -  * Debugger is active!
2025-09-15 17:52:16,648 - werkzeug - INFO -  * Debugger PIN: 691-175-853
2025-09-15 17:52:19,161 - werkzeug - INFO - 127.0.0.1 - - [15/Sep/2025 17:52:19] "POST /calculate HTTP/1.1" 200 -
2025-09-15 17:52:19,161 - Review.reviews.wifrp_review - INFO - Loading EOD data...
2025-09-15 17:52:19,161 - werkzeug - INFO - 127.0.0.1 - - [15/Sep/2025 17:52:19] "GET /task-status/2d38f94f-5e65-479f-89f8-e366ef006549 HTTP/1.1" 200 -
2025-09-15 17:52:21,167 - werkzeug - INFO - 127.0.0.1 - - [15/Sep/2025 17:52:21] "GET /task-status/2d38f94f-5e65-479f-89f8-e366ef006549 HTTP/1.1" 200 -
2025-09-15 17:52:21,658 - Review.reviews.wifrp_review - INFO - Loading reference data...
2025-09-15 17:52:23,174 - werkzeug - INFO - 127.0.0.1 - - [15/Sep/2025 17:52:23] "GET /task-status/2d38f94f-5e65-479f-89f8-e366ef006549 HTTP/1.1" 200 -
2025-09-15 17:52:25,174 - werkzeug - INFO - 127.0.0.1 - - [15/Sep/2025 17:52:25] "GET /task-status/2d38f94f-5e65-479f-89f8-e366ef006549 HTTP/1.1" 200 -
2025-09-15 17:52:27,167 - werkzeug - INFO - 127.0.0.1 - - [15/Sep/2025 17:52:27] "GET /task-status/2d38f94f-5e65-479f-89f8-e366ef006549 HTTP/1.1" 200 -
2025-09-15 17:52:29,191 - werkzeug - INFO - 127.0.0.1 - - [15/Sep/2025 17:52:29] "GET /task-status/2d38f94f-5e65-479f-89f8-e366ef006549 HTTP/1.1" 200 -
2025-09-15 17:52:31,168 - werkzeug - INFO - 127.0.0.1 - - [15/Sep/2025 17:52:31] "GET /task-status/2d38f94f-5e65-479f-89f8-e366ef006549 HTTP/1.1" 200 -
2025-09-15 17:52:32,743 - Review.reviews.wifrp_review - WARNING - Removed 2 duplicate rows from Oekom data
2025-09-15 17:52:32,745 - Review.reviews.wifrp_review - WARNING - Removed 10 duplicate rows from SESAMm data
2025-09-15 17:52:32,745 - Review.reviews.wifrp_review - INFO - Adding Index_Currency to stock_eod_df by looking up Index in index_eod_df...
2025-09-15 17:52:32,750 - Review.reviews.wifrp_review - INFO - Added Index_Currency to stock_eod_df. Found 61600 matches.
2025-09-15 17:52:32,754 - Review.reviews.wifrp_review - INFO - Added Index_Currency to stock_co_df. Found 61214 matches.
2025-09-15 17:52:32,755 - Review.reviews.wifrp_review - INFO - Filtering universe to exclude Euronext Paris (XPAR) listings...
2025-09-15 17:52:32,756 - Review.reviews.wifrp_review - INFO - Adding Free Float data...
2025-09-15 17:52:32,760 - Review.reviews.wifrp_review - INFO - Applying exclusion criteria...
2025-09-15 17:52:32,804 - Review.reviews.wifrp_review - WARNING - Removed 9446 duplicate rows from ICB data
2025-09-15 17:52:32,804 - Review.reviews.wifrp_review - INFO - Merging ICB data with 'Supersector Code' column
2025-09-15 17:52:32,826 - Review.reviews.wifrp_review - INFO - Processing sector: 1010.0, region: AS, group size: 46
2025-09-15 17:52:32,826 - Review.reviews.wifrp_review - INFO - Companies in group: 46, to exclude: 9
2025-09-15 17:52:32,826 - Review.reviews.wifrp_review - INFO - Processing sector: 1010.0, region: EU, group size: 20
2025-09-15 17:52:32,831 - Review.reviews.wifrp_review - INFO - Companies in group: 20, to exclude: 3
2025-09-15 17:52:32,831 - Review.reviews.wifrp_review - INFO - Processing sector: 1010.0, region: NA, group size: 86
2025-09-15 17:52:32,835 - Review.reviews.wifrp_review - INFO - Companies in group: 86, to exclude: 17
2025-09-15 17:52:32,835 - Review.reviews.wifrp_review - INFO - Processing sector: 1510.0, region: AS, group size: 12
2025-09-15 17:52:32,836 - Review.reviews.wifrp_review - INFO - Companies in group: 12, to exclude: 2
2025-09-15 17:52:32,836 - Review.reviews.wifrp_review - INFO - Processing sector: 1510.0, region: EU, group size: 18
2025-09-15 17:52:32,836 - Review.reviews.wifrp_review - INFO - Companies in group: 18, to exclude: 3
2025-09-15 17:52:32,836 - Review.reviews.wifrp_review - INFO - Processing sector: 1510.0, region: NA, group size: 10
2025-09-15 17:52:32,836 - Review.reviews.wifrp_review - INFO - Companies in group: 10, to exclude: 1
2025-09-15 17:52:32,836 - Review.reviews.wifrp_review - INFO - Processing sector: 2010.0, region: AS, group size: 30
2025-09-15 17:52:32,837 - Review.reviews.wifrp_review - INFO - Companies in group: 30, to exclude: 5
2025-09-15 17:52:32,837 - Review.reviews.wifrp_review - INFO - Processing sector: 2010.0, region: EU, group size: 40
2025-09-15 17:52:32,837 - Review.reviews.wifrp_review - INFO - Companies in group: 40, to exclude: 7
2025-09-15 17:52:32,837 - Review.reviews.wifrp_review - INFO - Processing sector: 2010.0, region: NA, group size: 44
2025-09-15 17:52:32,837 - Review.reviews.wifrp_review - INFO - Companies in group: 44, to exclude: 8
2025-09-15 17:52:32,837 - Review.reviews.wifrp_review - INFO - Processing sector: 3010.0, region: AS, group size: 32
2025-09-15 17:52:32,837 - Review.reviews.wifrp_review - INFO - Companies in group: 32, to exclude: 6
2025-09-15 17:52:32,837 - Review.reviews.wifrp_review - INFO - Processing sector: 3010.0, region: EU, group size: 43
2025-09-15 17:52:32,837 - Review.reviews.wifrp_review - INFO - Companies in group: 43, to exclude: 8
2025-09-15 17:52:32,837 - Review.reviews.wifrp_review - INFO - Processing sector: 3010.0, region: NA, group size: 20
2025-09-15 17:52:32,837 - Review.reviews.wifrp_review - INFO - Companies in group: 20, to exclude: 3
2025-09-15 17:52:32,837 - Review.reviews.wifrp_review - INFO - Processing sector: 3020.0, region: AS, group size: 17
2025-09-15 17:52:32,837 - Review.reviews.wifrp_review - INFO - Companies in group: 17, to exclude: 3
2025-09-15 17:52:32,837 - Review.reviews.wifrp_review - INFO - Processing sector: 3020.0, region: EU, group size: 30
2025-09-15 17:52:32,840 - Review.reviews.wifrp_review - INFO - Companies in group: 30, to exclude: 5
2025-09-15 17:52:32,840 - Review.reviews.wifrp_review - INFO - Processing sector: 3020.0, region: NA, group size: 32
2025-09-15 17:52:32,841 - Review.reviews.wifrp_review - INFO - Companies in group: 32, to exclude: 6
2025-09-15 17:52:32,841 - Review.reviews.wifrp_review - INFO - Processing sector: 3030.0, region: AS, group size: 14
2025-09-15 17:52:32,842 - Review.reviews.wifrp_review - INFO - Companies in group: 14, to exclude: 2
2025-09-15 17:52:32,842 - Review.reviews.wifrp_review - INFO - Processing sector: 3030.0, region: EU, group size: 28
2025-09-15 17:52:32,842 - Review.reviews.wifrp_review - INFO - Companies in group: 28, to exclude: 5
2025-09-15 17:52:32,842 - Review.reviews.wifrp_review - INFO - Processing sector: 3030.0, region: NA, group size: 23
2025-09-15 17:52:32,843 - Review.reviews.wifrp_review - INFO - Companies in group: 23, to exclude: 4
2025-09-15 17:52:32,843 - Review.reviews.wifrp_review - INFO - Processing sector: 3510.0, region: AS, group size: 46
2025-09-15 17:52:32,843 - Review.reviews.wifrp_review - INFO - Companies in group: 46, to exclude: 9
2025-09-15 17:52:32,844 - Review.reviews.wifrp_review - INFO - Processing sector: 3510.0, region: EU, group size: 22
2025-09-15 17:52:32,844 - Review.reviews.wifrp_review - INFO - Companies in group: 22, to exclude: 4
2025-09-15 17:52:32,844 - Review.reviews.wifrp_review - INFO - Processing sector: 3510.0, region: NA, group size: 19
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Companies in group: 19, to exclude: 3
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Processing sector: 4010.0, region: AS, group size: 16
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Companies in group: 16, to exclude: 3
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Processing sector: 4010.0, region: EU, group size: 10
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Companies in group: 10, to exclude: 1
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Processing sector: 4010.0, region: NA, group size: 4
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Companies in group: 4, to exclude: 0
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - WARNING - No companies to exclude for sector 4010.0 and region NA
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Processing sector: 4020.0, region: AS, group size: 25
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Companies in group: 25, to exclude: 4
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Processing sector: 4020.0, region: EU, group size: 16
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Companies in group: 16, to exclude: 3
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Processing sector: 4020.0, region: NA, group size: 18
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Companies in group: 18, to exclude: 3
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Processing sector: 4030.0, region: AS, group size: 6
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Companies in group: 6, to exclude: 1
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Processing sector: 4030.0, region: EU, group size: 6
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Companies in group: 6, to exclude: 1
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Processing sector: 4030.0, region: NA, group size: 6
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Companies in group: 6, to exclude: 1
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Processing sector: 4040.0, region: AS, group size: 13
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Companies in group: 13, to exclude: 2
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Processing sector: 4040.0, region: EU, group size: 8
2025-09-15 17:52:32,845 - Review.reviews.wifrp_review - INFO - Companies in group: 8, to exclude: 1
2025-09-15 17:52:32,851 - Review.reviews.wifrp_review - INFO - Processing sector: 4040.0, region: NA, group size: 21
2025-09-15 17:52:32,851 - Review.reviews.wifrp_review - INFO - Companies in group: 21, to exclude: 4
2025-09-15 17:52:32,851 - Review.reviews.wifrp_review - INFO - Processing sector: 4050.0, region: AS, group size: 19
2025-09-15 17:52:32,851 - Review.reviews.wifrp_review - INFO - Companies in group: 19, to exclude: 3
2025-09-15 17:52:32,851 - Review.reviews.wifrp_review - INFO - Processing sector: 4050.0, region: EU, group size: 10
2025-09-15 17:52:32,852 - Review.reviews.wifrp_review - INFO - Companies in group: 10, to exclude: 1
2025-09-15 17:52:32,852 - Review.reviews.wifrp_review - INFO - Processing sector: 4050.0, region: NA, group size: 18
2025-09-15 17:52:32,852 - Review.reviews.wifrp_review - INFO - Companies in group: 18, to exclude: 3
2025-09-15 17:52:32,852 - Review.reviews.wifrp_review - INFO - Processing sector: 4510.0, region: AS, group size: 24
2025-09-15 17:52:32,853 - Review.reviews.wifrp_review - INFO - Companies in group: 24, to exclude: 4
2025-09-15 17:52:32,853 - Review.reviews.wifrp_review - INFO - Processing sector: 4510.0, region: EU, group size: 23
2025-09-15 17:52:32,853 - Review.reviews.wifrp_review - INFO - Companies in group: 23, to exclude: 4
2025-09-15 17:52:32,853 - Review.reviews.wifrp_review - INFO - Processing sector: 4510.0, region: NA, group size: 17
2025-09-15 17:52:32,853 - Review.reviews.wifrp_review - INFO - Companies in group: 17, to exclude: 3
2025-09-15 17:52:32,853 - Review.reviews.wifrp_review - INFO - Processing sector: 4520.0, region: AS, group size: 17
2025-09-15 17:52:32,854 - Review.reviews.wifrp_review - INFO - Companies in group: 17, to exclude: 3
2025-09-15 17:52:32,854 - Review.reviews.wifrp_review - INFO - Processing sector: 4520.0, region: EU, group size: 12
2025-09-15 17:52:32,854 - Review.reviews.wifrp_review - INFO - Companies in group: 12, to exclude: 2
2025-09-15 17:52:32,854 - Review.reviews.wifrp_review - INFO - Processing sector: 4520.0, region: NA, group size: 12
2025-09-15 17:52:32,854 - Review.reviews.wifrp_review - INFO - Companies in group: 12, to exclude: 2
2025-09-15 17:52:32,854 - Review.reviews.wifrp_review - INFO - Processing sector: 5010.0, region: AS, group size: 19
2025-09-15 17:52:32,855 - Review.reviews.wifrp_review - INFO - Companies in group: 19, to exclude: 3
2025-09-15 17:52:32,855 - Review.reviews.wifrp_review - INFO - Processing sector: 5010.0, region: EU, group size: 23
2025-09-15 17:52:32,855 - Review.reviews.wifrp_review - INFO - Companies in group: 23, to exclude: 4
2025-09-15 17:52:32,855 - Review.reviews.wifrp_review - INFO - Processing sector: 5010.0, region: NA, group size: 11
2025-09-15 17:52:32,855 - Review.reviews.wifrp_review - INFO - Companies in group: 11, to exclude: 2
2025-09-15 17:52:32,855 - Review.reviews.wifrp_review - INFO - Processing sector: 5020.0, region: AS, group size: 92
2025-09-15 17:52:32,857 - Review.reviews.wifrp_review - INFO - Companies in group: 92, to exclude: 18
2025-09-15 17:52:32,857 - Review.reviews.wifrp_review - INFO - Processing sector: 5020.0, region: EU, group size: 83
2025-09-15 17:52:32,857 - Review.reviews.wifrp_review - INFO - Companies in group: 83, to exclude: 16
2025-09-15 17:52:32,858 - Review.reviews.wifrp_review - INFO - Processing sector: 5020.0, region: NA, group size: 79
2025-09-15 17:52:32,858 - Review.reviews.wifrp_review - INFO - Companies in group: 79, to exclude: 15
2025-09-15 17:52:32,858 - Review.reviews.wifrp_review - INFO - Processing sector: 5510.0, region: AS, group size: 24
2025-09-15 17:52:32,859 - Review.reviews.wifrp_review - INFO - Companies in group: 24, to exclude: 4
2025-09-15 17:52:32,859 - Review.reviews.wifrp_review - INFO - Processing sector: 5510.0, region: EU, group size: 16
2025-09-15 17:52:32,859 - Review.reviews.wifrp_review - INFO - Companies in group: 16, to exclude: 3
2025-09-15 17:52:32,859 - Review.reviews.wifrp_review - INFO - Processing sector: 5510.0, region: NA, group size: 12
2025-09-15 17:52:32,860 - Review.reviews.wifrp_review - INFO - Companies in group: 12, to exclude: 2
2025-09-15 17:52:32,860 - Review.reviews.wifrp_review - INFO - Processing sector: 5520.0, region: AS, group size: 17
2025-09-15 17:52:32,861 - Review.reviews.wifrp_review - INFO - Companies in group: 17, to exclude: 3
2025-09-15 17:52:32,861 - Review.reviews.wifrp_review - INFO - Processing sector: 5520.0, region: EU, group size: 15
2025-09-15 17:52:32,861 - Review.reviews.wifrp_review - INFO - Companies in group: 15, to exclude: 2
2025-09-15 17:52:32,861 - Review.reviews.wifrp_review - INFO - Processing sector: 5520.0, region: NA, group size: 4
2025-09-15 17:52:32,862 - Review.reviews.wifrp_review - INFO - Companies in group: 4, to exclude: 0
2025-09-15 17:52:32,862 - Review.reviews.wifrp_review - WARNING - No companies to exclude for sector 5520.0 and region NA
2025-09-15 17:52:32,862 - Review.reviews.wifrp_review - INFO - Processing sector: 6010.0, region: AS, group size: 10
2025-09-15 17:52:32,863 - Review.reviews.wifrp_review - INFO - Companies in group: 10, to exclude: 1
2025-09-15 17:52:32,863 - Review.reviews.wifrp_review - INFO - Processing sector: 6010.0, region: EU, group size: 18
2025-09-15 17:52:32,863 - Review.reviews.wifrp_review - INFO - Companies in group: 18, to exclude: 3
2025-09-15 17:52:32,863 - Review.reviews.wifrp_review - INFO - Processing sector: 6010.0, region: NA, group size: 33
2025-09-15 17:52:32,863 - Review.reviews.wifrp_review - INFO - Companies in group: 33, to exclude: 6
2025-09-15 17:52:32,864 - Review.reviews.wifrp_review - INFO - Processing sector: 6510.0, region: AS, group size: 21
2025-09-15 17:52:32,864 - Review.reviews.wifrp_review - INFO - Companies in group: 21, to exclude: 4
2025-09-15 17:52:32,864 - Review.reviews.wifrp_review - INFO - Processing sector: 6510.0, region: EU, group size: 24
2025-09-15 17:52:32,865 - Review.reviews.wifrp_review - INFO - Companies in group: 24, to exclude: 4
2025-09-15 17:52:32,865 - Review.reviews.wifrp_review - INFO - Processing sector: 6510.0, region: NA, group size: 31
2025-09-15 17:52:32,865 - Review.reviews.wifrp_review - INFO - Companies in group: 31, to exclude: 6
2025-09-15 17:52:32,866 - Review.reviews.wifrp_review - INFO - Calculating FFMC for all companies in universe...
2025-09-15 17:52:32,866 - Review.reviews.wifrp_review - INFO - Using Mcap in EUR to calculate FFMC
2025-09-15 17:52:32,866 - Review.reviews.wifrp_review - INFO - Creating rank based on FFMC...
2025-09-15 17:52:32,867 - Review.reviews.wifrp_review - INFO - Found 20 valid exclusion columns: ['exclusion_1', 'exclusion_2', 'exclusion_3', 'exclusion_4', 'exclusion_5', 'exclusion_6', 'exclusion_7', 'exclusion_8', 'exclusion_9', 'exclusion_10', 'exclusion_11', 'exclusion_12', 'exclusion_13', 'exclusion_14', 'exclusion_15', 'exclusion_16', 'exclusion_17', 'exclusion_18', 'exclusion_19', 'exclusion_20']
2025-09-15 17:52:32,882 - Review.reviews.wifrp_review - INFO - Selecting eligible companies...
2025-09-15 17:52:32,884 - Review.reviews.wifrp_review - INFO - Selecting top 40 companies by FFMC...
2025-09-15 17:52:32,884 - Review.reviews.wifrp_review - INFO - Adding Symbol column to final_selection...
2025-09-15 17:52:33,216 - werkzeug - INFO - 127.0.0.1 - - [15/Sep/2025 17:52:33] "GET /task-status/2d38f94f-5e65-479f-89f8-e366ef006549 HTTP/1.1" 200 -
2025-09-15 17:52:33,841 - Review.reviews.wifrp_review - INFO - Added Symbol to 40 companies out of 40
2025-09-15 17:52:33,841 - Review.reviews.wifrp_review - INFO - Calculating weights and capping factors using the most recent pricing data...
2025-09-15 17:52:33,844 - Review.reviews.wifrp_review - INFO - Found 1437 records with Index_Currency='EUR' for selected Symbols
2025-09-15 17:52:33,862 - Review.reviews.wifrp_review - INFO - Calculating post-capping weights...
2025-09-15 17:52:33,870 - Review.reviews.wifrp_review - INFO - Creating final output dataframe...
2025-09-15 17:52:33,875 - Review.reviews.wifrp_review - INFO - Saving WIFRP output to: C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\output\WIFRP_df_20250915_175233.xlsx
2025-09-15 17:52:35,168 - werkzeug - INFO - 127.0.0.1 - - [15/Sep/2025 17:52:35] "GET /task-status/2d38f94f-5e65-479f-89f8-e366ef006549 HTTP/1.1" 200 -
2025-09-15 17:57:50,162 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\OneDrive - Euronext\\Documents\\Projects\\GUI + Reviews\\Review\\reviews\\sectorial_review.py', reloading
2025-09-15 17:57:50,170 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\OneDrive - Euronext\\Documents\\Projects\\GUI + Reviews\\Review\\reviews\\sectorial_review.py', reloading
2025-09-15 17:57:50,170 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\OneDrive - Euronext\\Documents\\Projects\\GUI + Reviews\\Review\\reviews\\sectorial_review.py', reloading
