2025-03-31 16:20:50,510 - werkzeug - WARNING -  * Debugger is active!
2025-03-31 16:20:50,520 - werkzeug - INFO -  * Debugger PIN: 691-175-853
2025-03-31 16:20:50,644 - Review.reviews.wifrp_review - INFO - Loading EOD data...
2025-03-31 16:20:54,026 - Review.reviews.wifrp_review - INFO - Loading reference data...
2025-03-31 16:21:01,913 - Review.reviews.wifrp_review - INFO - Filtering universe to exclude Euronext Paris (XPAR) listings...
2025-03-31 16:21:01,914 - Review.reviews.wifrp_review - INFO - Adding Free Float data...
2025-03-31 16:21:01,918 - Review.reviews.wifrp_review - INFO - Applying exclusion criteria...
2025-03-31 16:21:01,937 - Review.reviews.wifrp_review - INFO - Merging ICB data with 'Supersector Code' column
2025-03-31 16:21:01,959 - Review.reviews.wifrp_review - INFO - Processing sector: 1010.0, region: AS, group size: 64
2025-03-31 16:21:01,960 - Review.reviews.wifrp_review - INFO - Companies in group: 64, to exclude: 12
2025-03-31 16:21:01,961 - Review.reviews.wifrp_review - INFO - Processing sector: 1010.0, region: EU, group size: 34
2025-03-31 16:21:01,961 - Review.reviews.wifrp_review - INFO - Companies in group: 34, to exclude: 6
2025-03-31 16:21:01,962 - Review.reviews.wifrp_review - INFO - Processing sector: 1010.0, region: NA, group size: 136
2025-03-31 16:21:01,962 - Review.reviews.wifrp_review - INFO - Companies in group: 136, to exclude: 27
2025-03-31 16:21:01,963 - Review.reviews.wifrp_review - INFO - Processing sector: 1510.0, region: AS, group size: 22
2025-03-31 16:21:01,963 - Review.reviews.wifrp_review - INFO - Companies in group: 22, to exclude: 4
2025-03-31 16:21:01,964 - Review.reviews.wifrp_review - INFO - Processing sector: 1510.0, region: EU, group size: 33
2025-03-31 16:21:01,964 - Review.reviews.wifrp_review - INFO - Companies in group: 33, to exclude: 6
2025-03-31 16:21:01,964 - Review.reviews.wifrp_review - INFO - Processing sector: 1510.0, region: NA, group size: 25
2025-03-31 16:21:01,965 - Review.reviews.wifrp_review - INFO - Companies in group: 25, to exclude: 4
2025-03-31 16:21:01,965 - Review.reviews.wifrp_review - INFO - Processing sector: 2010.0, region: AS, group size: 40
2025-03-31 16:21:01,966 - Review.reviews.wifrp_review - INFO - Companies in group: 40, to exclude: 7
2025-03-31 16:21:01,966 - Review.reviews.wifrp_review - INFO - Processing sector: 2010.0, region: EU, group size: 58
2025-03-31 16:21:01,966 - Review.reviews.wifrp_review - INFO - Companies in group: 58, to exclude: 11
2025-03-31 16:21:01,967 - Review.reviews.wifrp_review - INFO - Processing sector: 2010.0, region: NA, group size: 87
2025-03-31 16:21:01,967 - Review.reviews.wifrp_review - INFO - Companies in group: 87, to exclude: 17
2025-03-31 16:21:01,968 - Review.reviews.wifrp_review - INFO - Processing sector: 3010.0, region: AS, group size: 36
2025-03-31 16:21:01,968 - Review.reviews.wifrp_review - INFO - Companies in group: 36, to exclude: 7
2025-03-31 16:21:01,968 - Review.reviews.wifrp_review - INFO - Processing sector: 3010.0, region: EU, group size: 81
2025-03-31 16:21:01,969 - Review.reviews.wifrp_review - INFO - Companies in group: 81, to exclude: 16
2025-03-31 16:21:01,969 - Review.reviews.wifrp_review - INFO - Processing sector: 3010.0, region: NA, group size: 45
2025-03-31 16:21:01,969 - Review.reviews.wifrp_review - INFO - Companies in group: 45, to exclude: 8
2025-03-31 16:21:01,969 - Review.reviews.wifrp_review - INFO - Processing sector: 3020.0, region: AS, group size: 27
2025-03-31 16:21:01,970 - Review.reviews.wifrp_review - INFO - Companies in group: 27, to exclude: 5
2025-03-31 16:21:01,970 - Review.reviews.wifrp_review - INFO - Processing sector: 3020.0, region: EU, group size: 45
2025-03-31 16:21:01,970 - Review.reviews.wifrp_review - INFO - Companies in group: 45, to exclude: 8
2025-03-31 16:21:01,971 - Review.reviews.wifrp_review - INFO - Processing sector: 3020.0, region: NA, group size: 54
2025-03-31 16:21:01,971 - Review.reviews.wifrp_review - INFO - Companies in group: 54, to exclude: 10
2025-03-31 16:21:01,971 - Review.reviews.wifrp_review - INFO - Processing sector: 3030.0, region: AS, group size: 19
2025-03-31 16:21:01,972 - Review.reviews.wifrp_review - INFO - Companies in group: 19, to exclude: 3
2025-03-31 16:21:01,972 - Review.reviews.wifrp_review - INFO - Processing sector: 3030.0, region: EU, group size: 53
2025-03-31 16:21:01,972 - Review.reviews.wifrp_review - INFO - Companies in group: 53, to exclude: 10
2025-03-31 16:21:01,973 - Review.reviews.wifrp_review - INFO - Processing sector: 3030.0, region: NA, group size: 46
2025-03-31 16:21:01,973 - Review.reviews.wifrp_review - INFO - Companies in group: 46, to exclude: 9
2025-03-31 16:21:01,973 - Review.reviews.wifrp_review - INFO - Processing sector: 3510.0, region: AS, group size: 70
2025-03-31 16:21:01,974 - Review.reviews.wifrp_review - INFO - Companies in group: 70, to exclude: 13
2025-03-31 16:21:01,974 - Review.reviews.wifrp_review - INFO - Processing sector: 3510.0, region: EU, group size: 34
2025-03-31 16:21:01,974 - Review.reviews.wifrp_review - INFO - Companies in group: 34, to exclude: 6
2025-03-31 16:21:01,974 - Review.reviews.wifrp_review - INFO - Processing sector: 3510.0, region: NA, group size: 29
2025-03-31 16:21:01,975 - Review.reviews.wifrp_review - INFO - Companies in group: 29, to exclude: 5
2025-03-31 16:21:01,975 - Review.reviews.wifrp_review - INFO - Processing sector: 4010.0, region: AS, group size: 22
2025-03-31 16:21:01,976 - Review.reviews.wifrp_review - INFO - Companies in group: 22, to exclude: 4
2025-03-31 16:21:01,976 - Review.reviews.wifrp_review - INFO - Processing sector: 4010.0, region: EU, group size: 25
2025-03-31 16:21:01,977 - Review.reviews.wifrp_review - INFO - Companies in group: 25, to exclude: 4
2025-03-31 16:21:01,977 - Review.reviews.wifrp_review - INFO - Processing sector: 4010.0, region: NA, group size: 7
2025-03-31 16:21:01,978 - Review.reviews.wifrp_review - INFO - Companies in group: 7, to exclude: 1
2025-03-31 16:21:01,978 - Review.reviews.wifrp_review - INFO - Processing sector: 4020.0, region: AS, group size: 38
2025-03-31 16:21:01,978 - Review.reviews.wifrp_review - INFO - Companies in group: 38, to exclude: 7
2025-03-31 16:21:01,979 - Review.reviews.wifrp_review - INFO - Processing sector: 4020.0, region: EU, group size: 35
2025-03-31 16:21:01,979 - Review.reviews.wifrp_review - INFO - Companies in group: 35, to exclude: 6
2025-03-31 16:21:01,979 - Review.reviews.wifrp_review - INFO - Processing sector: 4020.0, region: NA, group size: 27
2025-03-31 16:21:01,979 - Review.reviews.wifrp_review - INFO - Companies in group: 27, to exclude: 5
2025-03-31 16:21:01,980 - Review.reviews.wifrp_review - INFO - Processing sector: 4030.0, region: AS, group size: 7
2025-03-31 16:21:01,980 - Review.reviews.wifrp_review - INFO - Companies in group: 7, to exclude: 1
2025-03-31 16:21:01,980 - Review.reviews.wifrp_review - INFO - Processing sector: 4030.0, region: EU, group size: 13
2025-03-31 16:21:01,981 - Review.reviews.wifrp_review - INFO - Companies in group: 13, to exclude: 2
2025-03-31 16:21:01,981 - Review.reviews.wifrp_review - INFO - Processing sector: 4030.0, region: NA, group size: 10
2025-03-31 16:21:01,981 - Review.reviews.wifrp_review - INFO - Companies in group: 10, to exclude: 1
2025-03-31 16:21:01,982 - Review.reviews.wifrp_review - INFO - Processing sector: 4040.0, region: AS, group size: 17
2025-03-31 16:21:01,982 - Review.reviews.wifrp_review - INFO - Companies in group: 17, to exclude: 3
2025-03-31 16:21:01,982 - Review.reviews.wifrp_review - INFO - Processing sector: 4040.0, region: EU, group size: 16
2025-03-31 16:21:01,983 - Review.reviews.wifrp_review - INFO - Companies in group: 16, to exclude: 3
2025-03-31 16:21:01,983 - Review.reviews.wifrp_review - INFO - Processing sector: 4040.0, region: NA, group size: 45
2025-03-31 16:21:01,983 - Review.reviews.wifrp_review - INFO - Companies in group: 45, to exclude: 8
2025-03-31 16:21:01,983 - Review.reviews.wifrp_review - INFO - Processing sector: 4050.0, region: AS, group size: 24
2025-03-31 16:21:01,984 - Review.reviews.wifrp_review - INFO - Companies in group: 24, to exclude: 4
2025-03-31 16:21:01,984 - Review.reviews.wifrp_review - INFO - Processing sector: 4050.0, region: EU, group size: 17
2025-03-31 16:21:01,985 - Review.reviews.wifrp_review - INFO - Companies in group: 17, to exclude: 3
2025-03-31 16:21:01,985 - Review.reviews.wifrp_review - INFO - Processing sector: 4050.0, region: NA, group size: 34
2025-03-31 16:21:01,985 - Review.reviews.wifrp_review - INFO - Companies in group: 34, to exclude: 6
2025-03-31 16:21:01,986 - Review.reviews.wifrp_review - INFO - Processing sector: 4510.0, region: AS, group size: 38
2025-03-31 16:21:01,988 - Review.reviews.wifrp_review - INFO - Companies in group: 38, to exclude: 7
2025-03-31 16:21:01,988 - Review.reviews.wifrp_review - INFO - Processing sector: 4510.0, region: EU, group size: 40
2025-03-31 16:21:01,988 - Review.reviews.wifrp_review - INFO - Companies in group: 40, to exclude: 7
2025-03-31 16:21:01,989 - Review.reviews.wifrp_review - INFO - Processing sector: 4510.0, region: NA, group size: 33
2025-03-31 16:21:01,989 - Review.reviews.wifrp_review - INFO - Companies in group: 33, to exclude: 6
2025-03-31 16:21:01,989 - Review.reviews.wifrp_review - INFO - Processing sector: 4520.0, region: AS, group size: 19
2025-03-31 16:21:01,989 - Review.reviews.wifrp_review - INFO - Companies in group: 19, to exclude: 3
2025-03-31 16:21:01,990 - Review.reviews.wifrp_review - INFO - Processing sector: 4520.0, region: EU, group size: 13
2025-03-31 16:21:01,990 - Review.reviews.wifrp_review - INFO - Companies in group: 13, to exclude: 2
2025-03-31 16:21:01,990 - Review.reviews.wifrp_review - INFO - Processing sector: 4520.0, region: NA, group size: 23
2025-03-31 16:21:01,990 - Review.reviews.wifrp_review - INFO - Companies in group: 23, to exclude: 4
2025-03-31 16:21:01,991 - Review.reviews.wifrp_review - INFO - Processing sector: 5010.0, region: AS, group size: 22
2025-03-31 16:21:01,991 - Review.reviews.wifrp_review - INFO - Companies in group: 22, to exclude: 4
2025-03-31 16:21:01,992 - Review.reviews.wifrp_review - INFO - Processing sector: 5010.0, region: EU, group size: 33
2025-03-31 16:21:01,992 - Review.reviews.wifrp_review - INFO - Companies in group: 33, to exclude: 6
2025-03-31 16:21:01,993 - Review.reviews.wifrp_review - INFO - Processing sector: 5010.0, region: NA, group size: 14
2025-03-31 16:21:01,993 - Review.reviews.wifrp_review - INFO - Companies in group: 14, to exclude: 2
2025-03-31 16:21:01,994 - Review.reviews.wifrp_review - INFO - Processing sector: 5020.0, region: AS, group size: 123
2025-03-31 16:21:01,994 - Review.reviews.wifrp_review - INFO - Companies in group: 123, to exclude: 24
2025-03-31 16:21:01,994 - Review.reviews.wifrp_review - INFO - Processing sector: 5020.0, region: EU, group size: 118
2025-03-31 16:21:01,995 - Review.reviews.wifrp_review - INFO - Companies in group: 118, to exclude: 23
2025-03-31 16:21:01,995 - Review.reviews.wifrp_review - INFO - Processing sector: 5020.0, region: NA, group size: 129
2025-03-31 16:21:01,995 - Review.reviews.wifrp_review - INFO - Companies in group: 129, to exclude: 25
2025-03-31 16:21:01,996 - Review.reviews.wifrp_review - INFO - Processing sector: 5510.0, region: AS, group size: 36
2025-03-31 16:21:01,996 - Review.reviews.wifrp_review - INFO - Companies in group: 36, to exclude: 7
2025-03-31 16:21:01,997 - Review.reviews.wifrp_review - INFO - Processing sector: 5510.0, region: EU, group size: 32
2025-03-31 16:21:01,997 - Review.reviews.wifrp_review - INFO - Companies in group: 32, to exclude: 6
2025-03-31 16:21:01,997 - Review.reviews.wifrp_review - INFO - Processing sector: 5510.0, region: NA, group size: 28
2025-03-31 16:21:01,998 - Review.reviews.wifrp_review - INFO - Companies in group: 28, to exclude: 5
2025-03-31 16:21:01,998 - Review.reviews.wifrp_review - INFO - Processing sector: 5520.0, region: AS, group size: 24
2025-03-31 16:21:01,998 - Review.reviews.wifrp_review - INFO - Companies in group: 24, to exclude: 4
2025-03-31 16:21:01,998 - Review.reviews.wifrp_review - INFO - Processing sector: 5520.0, region: EU, group size: 31
2025-03-31 16:21:01,999 - Review.reviews.wifrp_review - INFO - Companies in group: 31, to exclude: 6
2025-03-31 16:21:01,999 - Review.reviews.wifrp_review - INFO - Processing sector: 5520.0, region: NA, group size: 13
2025-03-31 16:21:01,999 - Review.reviews.wifrp_review - INFO - Companies in group: 13, to exclude: 2
2025-03-31 16:21:01,999 - Review.reviews.wifrp_review - INFO - Processing sector: 6010.0, region: AS, group size: 16
2025-03-31 16:21:02,000 - Review.reviews.wifrp_review - INFO - Companies in group: 16, to exclude: 3
2025-03-31 16:21:02,000 - Review.reviews.wifrp_review - INFO - Processing sector: 6010.0, region: EU, group size: 27
2025-03-31 16:21:02,000 - Review.reviews.wifrp_review - INFO - Companies in group: 27, to exclude: 5
2025-03-31 16:21:02,000 - Review.reviews.wifrp_review - INFO - Processing sector: 6010.0, region: NA, group size: 65
2025-03-31 16:21:02,000 - Review.reviews.wifrp_review - INFO - Companies in group: 65, to exclude: 12
2025-03-31 16:21:02,001 - Review.reviews.wifrp_review - INFO - Processing sector: 6510.0, region: AS, group size: 32
2025-03-31 16:21:02,001 - Review.reviews.wifrp_review - INFO - Companies in group: 32, to exclude: 6
2025-03-31 16:21:02,002 - Review.reviews.wifrp_review - INFO - Processing sector: 6510.0, region: EU, group size: 40
2025-03-31 16:21:02,002 - Review.reviews.wifrp_review - INFO - Companies in group: 40, to exclude: 7
2025-03-31 16:21:02,002 - Review.reviews.wifrp_review - INFO - Processing sector: 6510.0, region: NA, group size: 45
2025-03-31 16:21:02,003 - Review.reviews.wifrp_review - INFO - Companies in group: 45, to exclude: 8
2025-03-31 16:21:02,004 - Review.reviews.wifrp_review - INFO - Found 20 valid exclusion columns: ['exclusion_1', 'exclusion_2', 'exclusion_3', 'exclusion_4', 'exclusion_5', 'exclusion_6', 'exclusion_7', 'exclusion_8', 'exclusion_9', 'exclusion_10', 'exclusion_11', 'exclusion_12', 'exclusion_13', 'exclusion_14', 'exclusion_15', 'exclusion_16', 'exclusion_17', 'exclusion_18', 'exclusion_20', 'exclusion_21']
2025-03-31 16:21:02,004 - Review.reviews.wifrp_review - INFO - Selecting eligible companies...
2025-03-31 16:21:02,005 - Review.reviews.wifrp_review - INFO - Available columns in eligible_df: ['Rank', 'Ticker', 'Company', 'ISIN Code', 'MIC', 'Number of Shares', 'Price (EUR) ', 'Currency', 'Mcap in EUR', 'index', '3 months ADTV', 'Free Float', 'exclusion_1', 'exclusion_2', 'NBR Overall Flag', 'exclusion_3', 'Biological Weapons - Overall Flag', 'Chemical Weapons - Overall Flag', 'Nuclear Weapons Inside NPT - Overall Flag', 'Nuclear Weapons Outside NPT - Overall Flag', 'Cluster Munitions - Overall Flag', 'Depleted Uranium - Overall Flag', 'Anti-personnel Mines - Overall Flag', 'White Phosphorous Weapons - Overall Flag', 'exclusion_4', 'exclusion_5', 'exclusion_6', 'exclusion_7', 'exclusion_8', 'exclusion_9', 'exclusion_10', 'exclusion_11', 'AnimalWelfareInvolvement', 'AnimalWelfareAnimTestInvolvement', 'exclusion_12', 'exclusion_13', 'Coal Mining and Power Gen - Maximum Percentage of Revenues (%)', 'Fossil Fuel - Total Maximum Percentage of Revenues (%)', 'Power Generation - Thermal Maximum Percentage of Revenues (%)', 'exclusion_14', 'exclusion_15', 'exclusion_16', 'Tobacco - Production Maximum Percentage of Revenues (%)', 'Tobacco - Distribution Maximum Percentage of Revenues (%)', 'exclusion_17', 'exclusion_18', 'layoff_score_3m', 'exclusion_20', 'Supersector', 'CRStaffRatingNum', 'Region', 'exclusion_21']
2025-03-31 16:21:02,006 - Review.reviews.wifrp_review - INFO - Calculating FFMC...
2025-03-31 16:21:02,006 - Review.reviews.wifrp_review - ERROR - Column 'Price (EUR)' not found in eligible_df
2025-03-31 16:21:02,007 - Review.reviews.wifrp_review - INFO - Found similar price columns: ['Price (EUR) ', 'Mcap in EUR']
2025-03-31 16:21:02,007 - Review.reviews.wifrp_review - INFO - Using 'Mcap in EUR' to calculate price
2025-03-31 16:21:02,008 - Review.reviews.wifrp_review - INFO - Selecting top 40 companies by FFMC...
2025-03-31 16:21:02,008 - Review.reviews.wifrp_review - INFO - Calculating capping factors...
2025-03-31 16:21:02,011 - Review.reviews.wifrp_review - INFO - Creating final output dataframe...
2025-03-31 16:21:02,012 - Review.reviews.wifrp_review - INFO - Saving WIFRP output to: C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\output\WIFRP_df_20250331_162102.xlsx
2025-03-31 16:21:02,761 - werkzeug - INFO - 127.0.0.1 - - [31/Mar/2025 16:21:02] "POST /calculate HTTP/1.1" 200 -
2025-03-31 16:26:29,994 - werkzeug - INFO -  * Detected change in 'C:\\Program Files\\Python312\\Lib\\os.py', reloading
