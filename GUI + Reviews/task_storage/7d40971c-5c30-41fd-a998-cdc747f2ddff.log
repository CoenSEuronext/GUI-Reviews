Starting EZGP review at 2026-02-11 17:32:58.417561
2026-02-11 17:32:58,751 - Review.reviews.ezgp_review - INFO - Loading EOD data...
Loaded index data from 2 file(s)
Loaded stock EOD data from 2 file(s)
Loaded stock CO data from 2 file(s)
Created FX lookup table with 35 unique currency pairs
Available currency pairs: 15 currencies -> 6 index currencies
2026-02-11 17:32:59,653 - Review.reviews.ezgp_review - INFO - Loading reference data...
2026-02-11 17:32:59,751 - Review.reviews.ezgp_review - INFO - Starting universe size: 300
2026-02-11 17:32:59,834 - Review.reviews.ezgp_review - INFO - Step 2.1: Filtering by 3-month Average Daily Traded Value...
2026-02-11 17:32:59,834 - Review.reviews.ezgp_review - INFO - After ADTV filter (>= 40,000,000 EUR): 105 companies (excluded 195)
2026-02-11 17:32:59,834 - Review.reviews.ezgp_review - INFO - Step 2.2: Carbon Emission Data filter - skipped for now
2026-02-11 17:32:59,834 - Review.reviews.ezgp_review - INFO - Step 2.3: Filtering to Eurozone countries...
2026-02-11 17:32:59,834 - Review.reviews.ezgp_review - INFO - After Eurozone filter: 102 companies
2026-02-11 17:32:59,834 - Review.reviews.ezgp_review - INFO - Merging Sustainalytics data...
2026-02-11 17:32:59,834 - Review.reviews.ezgp_review - INFO - Sustainalytics merge completed. Added 28 columns.
2026-02-11 17:32:59,834 - Review.reviews.ezgp_review - INFO - Applying exclusion criteria...
2026-02-11 17:32:59,848 - Review.reviews.ezgp_review - INFO - Exclusion criteria applied. 102 companies excluded.
2026-02-11 17:32:59,848 - Review.reviews.ezgp_review - INFO - After exclusions: 0 companies eligible
2026-02-11 17:32:59,849 - Review.reviews.ezgp_review - INFO - Step 2.6: Ranking by ESG Risk Score (lower is better)...
2026-02-11 17:32:59,849 - Review.reviews.ezgp_review - WARNING - ESG Risk Score (181110112399) not available. Skipping ESG ranking.
2026-02-11 17:32:59,849 - Review.reviews.ezgp_review - INFO - Step 2.7: Selecting top 40 companies with lowest ESG Risk Score...
2026-02-11 17:32:59,849 - Review.reviews.ezgp_review - INFO - Pre-selection: 0 companies
2026-02-11 17:32:59,849 - Review.reviews.ezgp_review - INFO - Step 3: Ranking pre-selected companies by FFMC...
2026-02-11 17:32:59,849 - Review.reviews.ezgp_review - INFO - Step 4: Selecting top 20 companies with max 5 per Industry Code...
2026-02-11 17:32:59,851 - Review.reviews.ezgp_review - INFO - Final selection: 0 companies
2026-02-11 17:32:59,851 - Review.reviews.ezgp_review - INFO - Industry distribution: {}
2026-02-11 17:32:59,851 - Review.reviews.ezgp_review - INFO - Applying 10% capping using most recent pricing data...
2026-02-11 17:32:59,851 - Review.reviews.ezgp_review - ERROR - Error during review calculation: 'Free Float'
2026-02-11 17:32:59,855 - Review.reviews.ezgp_review - ERROR - Traceback (most recent call last):
  File "C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\Review\reviews\ezgp_review.py", line 510, in run_ezgp_review
    final_selection_df['EOD_FFMC'] = final_selection_df['Free Float'] * final_selection_df['Number of Shares'] * final_selection_df['Close Prc_EOD'] * final_selection_df['FX/Index Ccy']
                                     ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexes\range.py", line 417, in get_loc
    raise KeyError(key)
KeyError: 'Free Float'
Completed EZGP review in 1.44 seconds
