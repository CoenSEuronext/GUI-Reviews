2026-01-04 20:11:40,759 - werkzeug - WARNING -  * Debugger is active!
2026-01-04 20:11:40,761 - werkzeug - INFO -  * Debugger PIN: 691-175-853
2026-01-04 20:11:40,813 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:11:40] "GET /task-status/6f477f50-e0e7-4940-b833-a2d466bf3c2c HTTP/1.1" 200 -
2026-01-04 20:11:46,565 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:11:46] "POST /calculate-batch HTTP/1.1" 200 -
2026-01-04 20:11:46,570 - Review.reviews.envb_review - INFO - Loading EOD data...
2026-01-04 20:11:46,571 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:11:46] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:11:47,658 - Review.reviews.envb_review - INFO - Loading reference data...
2026-01-04 20:11:48,584 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:11:48] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:11:50,584 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:11:50] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:11:52,613 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:11:52] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:11:54,598 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:11:54] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:11:56,597 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:11:56] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:11:58,578 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:11:58] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:11:59,512 - Review.reviews.envb_review - INFO - Starting universe size: 500 stocks
2026-01-04 20:11:59,512 - Review.reviews.envb_review - INFO - Step 1: Filtering Index Universe to AMS/BRU/LUX exchanges...
2026-01-04 20:11:59,514 - Review.reviews.envb_review - INFO - Universe size after exchange filtering: 46 stocks
2026-01-04 20:11:59,515 - Review.reviews.envb_review - INFO - Step 2: Applying ESG compliance screening...
2026-01-04 20:11:59,515 - Review.reviews.envb_review - INFO - Universe size after ESG screening: 46 stocks
2026-01-04 20:11:59,517 - Review.reviews.envb_review - INFO - Step 3: Ranking by ESG Risk Rating and Free Float Market Cap...
2026-01-04 20:11:59,524 - Review.reviews.envb_review - INFO - Step 4: Selecting top 20 constituents...
2026-01-04 20:11:59,525 - Review.reviews.envb_review - INFO - Selected 20 constituents for ENVB index
2026-01-04 20:11:59,525 - Review.reviews.envb_review - INFO - Calculating ESG-based weights...
2026-01-04 20:11:59,527 - Review.reviews.envb_review - INFO - Applying 10% weight cap...
2026-01-04 20:11:59,529 - Review.reviews.envb_review - INFO - Capping completed in 0 iterations
2026-01-04 20:11:59,529 - Review.reviews.envb_review - INFO - Weight range: 3.57% to 7.12%
2026-01-04 20:11:59,535 - Review.reviews.envb_review - INFO - Performing inclusion/exclusion analysis...
2026-01-04 20:11:59,546 - Review.reviews.envb_review - INFO - Inclusions: 14, Exclusions: 14
2026-01-04 20:11:59,547 - Review.reviews.envb_review - INFO - Saving ENVB output to: C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\output\ENVB_df_20260104_201159.xlsx
2026-01-04 20:11:59,918 - Review.reviews.enveo_review - INFO - Loading EOD data...
2026-01-04 20:12:00,572 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:00] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:01,079 - Review.reviews.enveo_review - INFO - Loading reference data...
2026-01-04 20:12:02,589 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:02] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:04,580 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:04] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:06,593 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:06] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:08,579 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:08] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:10,573 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:10] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:12,608 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:12] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:14,407 - Review.reviews.enveo_review - INFO - Universe rows: 300 | Missing #Symbol: 2 | Missing CO price: 2 | Missing CO FX(EUR): 2 | Missing ESG score: 2 | Missing Free Float %: 0
2026-01-04 20:12:14,407 - Review.reviews.enveo_review - INFO - Starting universe size: 300
2026-01-04 20:12:14,407 - Review.reviews.enveo_review - INFO - Step 2: Excluding Sustainalytics Non-Compliant companies...
2026-01-04 20:12:14,408 - Review.reviews.enveo_review - INFO - Universe size after Non-Compliant screening: 300
2026-01-04 20:12:14,408 - Review.reviews.enveo_review - INFO - Step 3: Ranking by ESG Risk Score and FF Market Cap (CO)...
2026-01-04 20:12:14,413 - Review.reviews.enveo_review - INFO - Step 4: Selecting top 120 constituents...
2026-01-04 20:12:14,413 - Review.reviews.enveo_review - INFO - Selected 120 constituents for ENVEO
2026-01-04 20:12:14,414 - Review.reviews.enveo_review - INFO - Calculating ESG-based weights (1 / ESG risk)...
2026-01-04 20:12:14,417 - Review.reviews.enveo_review - INFO - Applying 10% max weight cap (iterative)...
2026-01-04 20:12:14,418 - Review.reviews.enveo_review - INFO - Capping iterations: 0
2026-01-04 20:12:14,418 - Review.reviews.enveo_review - INFO - Weight range: 0.59% to 2.28% (<= 10% expected)
2026-01-04 20:12:14,422 - Review.reviews.enveo_review - INFO - Performing inclusion/exclusion analysis...
2026-01-04 20:12:14,427 - Review.reviews.enveo_review - INFO - Inclusions: 70, Exclusions: 70
2026-01-04 20:12:14,428 - Review.reviews.enveo_review - INFO - Saving ENVEO output to: C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\output\ENVEO_review_20260104_201214.xlsx
2026-01-04 20:12:14,573 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:14] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:14,769 - Review.reviews.enveu_review - INFO - Loading EOD data...
2026-01-04 20:12:16,573 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:16] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:16,933 - Review.reviews.enveu_review - INFO - Loading reference data...
2026-01-04 20:12:18,582 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:18] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:20,577 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:20] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:22,575 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:22] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:24,579 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:24] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:26,586 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:26] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:28,626 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:28] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:30,575 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:30] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:32,006 - Review.reviews.enveu_review - INFO - Building ISIN+MIC -> #Symbol mapping (RIC mode, len(#Symbol) < 12)...
2026-01-04 20:12:32,112 - Review.reviews.enveu_review - INFO - Universe rows: 500 | Missing #Symbol: 3 | Missing FX: 3 | Missing EOD price: 3
2026-01-04 20:12:32,112 - Review.reviews.enveu_review - INFO - Step 1: Using universe 'EUROPE_500' as starting set...
2026-01-04 20:12:32,114 - Review.reviews.enveu_review - INFO - Starting universe size: 500 stocks
2026-01-04 20:12:32,114 - Review.reviews.enveu_review - INFO - Step 2: Applying Sustainalytics NON-COMPLIANT exclusion...
2026-01-04 20:12:32,115 - Review.reviews.enveu_review - INFO - Universe size after NON-COMPLIANT screening: 500 stocks
2026-01-04 20:12:32,115 - Review.reviews.enveu_review - INFO - Step 3: Ranking by ESG Risk Score and Free Float Market Cap...
2026-01-04 20:12:32,119 - Review.reviews.enveu_review - INFO - Step 4: Selecting top 120 constituents...
2026-01-04 20:12:32,120 - Review.reviews.enveu_review - INFO - Selected 120 constituents for ENVEU index
2026-01-04 20:12:32,120 - Review.reviews.enveu_review - INFO - Calculating ESG-based weights...
2026-01-04 20:12:32,125 - Review.reviews.enveu_review - INFO - Applying 10% weight cap...
2026-01-04 20:12:32,126 - Review.reviews.enveu_review - INFO - Capping completed in 0 iterations
2026-01-04 20:12:32,127 - Review.reviews.enveu_review - INFO - Weight range: 0.61% to 2.11%
2026-01-04 20:12:32,132 - Review.reviews.enveu_review - INFO - Performing inclusion/exclusion analysis...
2026-01-04 20:12:32,138 - Review.reviews.enveu_review - INFO - Inclusions: 87, Exclusions: 88
2026-01-04 20:12:32,139 - Review.reviews.enveu_review - INFO - Saving ENVEU output to: C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\output\ENVEU_df_20260104_201232.xlsx
2026-01-04 20:12:32,461 - Review.reviews.envf_review - INFO - Loading EOD data...
2026-01-04 20:12:32,580 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:32] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:34,575 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:34] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:34,803 - Review.reviews.envf_review - INFO - Loading reference data (CAC Family PX1 + Sustainalytics)...
2026-01-04 20:12:36,586 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:36] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:38,411 - Review.reviews.envf_review - ERROR - Error during review calculation: Missing reference data: CAC Family.xlsx (sheet PX1)
2026-01-04 20:12:38,413 - Review.reviews.envf_review - ERROR - Traceback (most recent call last):
  File "C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\Review\reviews\envf_review.py", line 81, in run_envf_review
    raise ValueError(f"Missing reference data: {', '.join(missing)}")
ValueError: Missing reference data: CAC Family.xlsx (sheet PX1)

2026-01-04 20:12:38,429 - Review.reviews.envuk_review - INFO - Loading EOD data...
2026-01-04 20:12:38,576 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:38] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:39,413 - Review.reviews.envuk_review - INFO - Loading reference data...
2026-01-04 20:12:40,584 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:40] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:42,580 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:42] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:44,590 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:44] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:46,578 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:46] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:48,580 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:48] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:50,577 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:50] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:12:52,104 - Review.reviews.envuk_review - INFO - Building ISIN+MIC -> #Symbol mapping (RIC mode, len(#Symbol) < 12)...
2026-01-04 20:12:52,180 - Review.reviews.envuk_review - INFO - Universe rows: 500 | Missing #Symbol: 3 | Missing EUR price: 3 | Missing FX: 3
2026-01-04 20:12:52,181 - Review.reviews.envuk_review - INFO - Step 1: Using Euronext Europe 500 as starting universe...
2026-01-04 20:12:52,181 - Review.reviews.envuk_review - INFO - Starting universe size: 500 stocks
2026-01-04 20:12:52,181 - Review.reviews.envuk_review - INFO - Filtering for Main Listing on London Stock Exchange (MIC: XLON)...
2026-01-04 20:12:52,182 - Review.reviews.envuk_review - INFO - Universe size after MIC filter (XLON): 107 stocks
2026-01-04 20:12:52,182 - Review.reviews.envuk_review - INFO - Step 2: Applying Sustainalytics NON-COMPLIANT exclusion...
2026-01-04 20:12:52,183 - Review.reviews.envuk_review - INFO - Universe size after NON-COMPLIANT screening: 107 stocks
2026-01-04 20:12:52,183 - Review.reviews.envuk_review - INFO - Step 3: Ranking by ESG Risk Score and Free Float Market Cap...
2026-01-04 20:12:52,185 - Review.reviews.envuk_review - INFO - Step 4: Selecting top 20 constituents...
2026-01-04 20:12:52,186 - Review.reviews.envuk_review - INFO - Selected 20 constituents for ENVUK index
2026-01-04 20:12:52,186 - Review.reviews.envuk_review - INFO - Calculating ESG-based weights (1 / ESG risk score)...
2026-01-04 20:12:52,188 - Review.reviews.envuk_review - INFO - Weight range: 3.54% to 9.55%
2026-01-04 20:12:52,196 - Review.reviews.envuk_review - INFO - Performing inclusion/exclusion analysis...
2026-01-04 20:12:52,202 - Review.reviews.envuk_review - INFO - Inclusions: 14, Exclusions: 15
2026-01-04 20:12:52,203 - Review.reviews.envuk_review - INFO - Saving ENVUK output to: C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\output\ENVUK_df_20260104_201252.xlsx
2026-01-04 20:12:52,573 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:12:52] "GET /task-status/3cf80481-84bc-4e9b-8a6d-10797319f20f HTTP/1.1" 200 -
2026-01-04 20:14:36,370 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:14:36] "POST /calculate HTTP/1.1" 200 -
2026-01-04 20:14:36,373 - Review.reviews.envf_review - INFO - Loading EOD data...
2026-01-04 20:14:36,376 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:14:36] "GET /task-status/912dc511-ea91-4985-99b9-85a287ab2d4e HTTP/1.1" 200 -
2026-01-04 20:14:38,390 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:14:38] "GET /task-status/912dc511-ea91-4985-99b9-85a287ab2d4e HTTP/1.1" 200 -
2026-01-04 20:14:38,607 - Review.reviews.envf_review - INFO - Loading reference data (CAC Family PX1 + Sustainalytics)...
2026-01-04 20:14:40,400 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:14:40] "GET /task-status/912dc511-ea91-4985-99b9-85a287ab2d4e HTTP/1.1" 200 -
2026-01-04 20:14:42,030 - Review.reviews.envf_review - INFO - Universe rows: 40 | Missing #Symbol: 0 | Missing FX: 0 | Missing EOD price: 0
2026-01-04 20:14:42,031 - Review.reviews.envf_review - INFO - Step 2: Applying Sustainalytics NON-COMPLIANT exclusion...
2026-01-04 20:14:42,032 - Review.reviews.envf_review - INFO - Universe size after ESG screening: 40
2026-01-04 20:14:42,033 - Review.reviews.envf_review - INFO - Step 3: Ranking by ESG Risk Score and FF Market Cap...
2026-01-04 20:14:42,037 - Review.reviews.envf_review - INFO - Step 4: Selecting top 20 constituents...
2026-01-04 20:14:42,037 - Review.reviews.envf_review - INFO - Calculating ESG-based weights and applying 10% cap...
2026-01-04 20:14:42,049 - Review.reviews.envf_review - INFO - Performing inclusion/exclusion analysis...
2026-01-04 20:14:42,052 - Review.reviews.envf_review - INFO - Inclusions: 11, Exclusions: 11
2026-01-04 20:14:42,053 - Review.reviews.envf_review - INFO - Saving ENVF output to: C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\output\ENVF_df_20260104_201442.xlsx
2026-01-04 20:14:42,380 - werkzeug - INFO - 127.0.0.1 - - [04/Jan/2026 20:14:42] "GET /task-status/912dc511-ea91-4985-99b9-85a287ab2d4e HTTP/1.1" 200 -
2026-01-04 20:15:26,303 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\AppData\\Roaming\\Python\\Python312\\site-packages\\numpy\\_typing\\_nested_sequence.py', reloading
2026-01-04 20:15:26,303 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\AppData\\Roaming\\Python\\Python312\\site-packages\\numpy\\_typing\\_dtype_like.py', reloading
2026-01-04 20:15:26,319 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\AppData\\Roaming\\Python\\Python312\\site-packages\\numpy\\_typing\\_shape.py', reloading
2026-01-04 20:15:26,325 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\AppData\\Roaming\\Python\\Python312\\site-packages\\numpy\\_typing\\_scalars.py', reloading
