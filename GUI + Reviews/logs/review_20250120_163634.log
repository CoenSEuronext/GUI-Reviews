2025-01-20 16:36:34,985 - werkzeug - WARNING -  * Debugger is active!
2025-01-20 16:36:34,987 - werkzeug - INFO -  * Debugger PIN: 691-175-853
2025-01-20 16:36:35,929 - Review.reviews.edwpt_review - INFO - Starting EDWPT review calculation
2025-01-20 16:36:40,314 - Review.reviews.edwpt_review - INFO - 
EDWPT Selection Summary:
2025-01-20 16:36:40,316 - Review.reviews.edwpt_review - INFO - Total companies selected: 5446
2025-01-20 16:36:40,317 - Review.reviews.edwpt_review - INFO - Total FFMC covered: 98.84%
2025-01-20 16:36:40,341 - Review.reviews.edwpt_review - INFO - 
DEUPT Selection Summary:
2025-01-20 16:36:40,342 - Review.reviews.edwpt_review - INFO - Total companies selected: 1327
2025-01-20 16:36:40,343 - Review.reviews.edwpt_review - INFO - Total FFMC covered: 98.67%
2025-01-20 16:36:40,358 - Review.reviews.edwpt_review - INFO - 
DEZPT Selection Summary:
2025-01-20 16:36:40,359 - Review.reviews.edwpt_review - INFO - Total companies selected: 494
2025-01-20 16:36:40,360 - Review.reviews.edwpt_review - INFO - Total FFMC covered: 98.51%
2025-01-20 16:36:40,376 - Review.reviews.edwpt_review - INFO - 
DAPPT Selection Summary:
2025-01-20 16:36:40,378 - Review.reviews.edwpt_review - INFO - Total companies selected: 1909
2025-01-20 16:36:40,379 - Review.reviews.edwpt_review - INFO - Total FFMC covered: 98.13%
2025-01-20 16:36:40,391 - Review.reviews.edwpt_review - INFO - 
DNAPT Selection Summary:
2025-01-20 16:36:40,392 - Review.reviews.edwpt_review - INFO - Total companies selected: 1764
2025-01-20 16:36:40,393 - Review.reviews.edwpt_review - INFO - Total FFMC covered: 98.18%
2025-01-20 16:36:40,405 - Review.reviews.edwpt_review - INFO - 
DASPT Selection Summary:
2025-01-20 16:36:40,406 - Review.reviews.edwpt_review - INFO - Total companies selected: 1563
2025-01-20 16:36:40,408 - Review.reviews.edwpt_review - INFO - Total FFMC covered: 98.07%
2025-01-20 16:36:40,415 - Review.reviews.edwpt_review - INFO - 
DPAPT Selection Summary:
2025-01-20 16:36:40,416 - Review.reviews.edwpt_review - INFO - Total companies selected: 320
2025-01-20 16:36:40,417 - Review.reviews.edwpt_review - INFO - Total FFMC covered: 98.04%
2025-01-20 16:36:40,427 - Review.reviews.edwpt_review - INFO - 
EUSPT Selection Summary:
2025-01-20 16:36:40,428 - Review.reviews.edwpt_review - INFO - Total companies selected: 1481
2025-01-20 16:36:40,430 - Review.reviews.edwpt_review - INFO - Total FFMC covered: 98.00%
2025-01-20 16:36:40,439 - Review.reviews.edwpt_review - INFO - 
EJPPT Selection Summary:
2025-01-20 16:36:40,440 - Review.reviews.edwpt_review - INFO - Total companies selected: 1414
2025-01-20 16:36:40,444 - Review.reviews.edwpt_review - INFO - Total FFMC covered: 98.00%
2025-01-20 16:36:40,450 - Review.reviews.edwpt_review - INFO - 
ECHPT Selection Summary:
2025-01-20 16:36:40,451 - Review.reviews.edwpt_review - INFO - Total companies selected: 74
2025-01-20 16:36:40,451 - Review.reviews.edwpt_review - INFO - Total FFMC covered: 98.05%
2025-01-20 16:36:40,457 - Review.reviews.edwpt_review - INFO - 
EUKPT Selection Summary:
2025-01-20 16:36:40,458 - Review.reviews.edwpt_review - INFO - Total companies selected: 320
2025-01-20 16:36:40,459 - Review.reviews.edwpt_review - INFO - Total FFMC covered: 98.01%
2025-01-20 16:36:40,464 - Review.reviews.edwpt_review - INFO - 
CANPT Selection Summary:
2025-01-20 16:36:40,465 - Review.reviews.edwpt_review - INFO - Total companies selected: 230
2025-01-20 16:36:40,466 - Review.reviews.edwpt_review - INFO - Total FFMC covered: 98.02%
2025-01-20 16:36:40,475 - Review.reviews.edwpt_review - INFO - 
Global Selection Summary:
2025-01-20 16:36:40,475 - Review.reviews.edwpt_review - INFO - Total companies selected: 5446
2025-01-20 16:36:40,478 - Review.reviews.edwpt_review - INFO - Total FFMC covered: 98.84%
2025-01-20 16:36:40,480 - Review.reviews.edwpt_review - INFO - 
MIC-level Summary:
2025-01-20 16:36:40,480 - Review.reviews.edwpt_review - INFO -       ISIN          FFMC  EDWPT_selection
MIC                                      
ALXP     1  1.337544e+09                1
BATS     3  1.962934e+10                1
MERK     2  2.803735e+08                2
MTAA   246  5.292374e+11               85
WBAH    26  5.370078e+10               17
XAMS    79  1.157401e+12               44
XASX   886  1.442942e+12              283
XBRU    58  1.938564e+11               34
XCSE   107  6.350474e+11               36
XESM     2  1.794035e+09                2
XETR   227  1.472409e+12              106
XHEL   127  2.061674e+11               49
XHKG   209  3.465502e+11               69
XLIS    18  3.541669e+10               11
XLON   872  2.336733e+12              320
XMAD    99  4.808796e+11               41
XMSM    14  5.274635e+10               10
XNGM    47  4.908139e+08                1
XNGS  2628  2.418978e+13              773
XNYS  1736  2.534917e+13             1143
XNZE    52  6.656698e+10               35
XOSL   245  1.738210e+11              125
XPAR   351  1.866583e+12               94
XSES   118  2.570802e+11               62
XSTO   648  7.073552e+11              222
XSWX   148  1.669679e+12               86
XTAE   275  1.399417e+11              150
XTKS  3711  4.991981e+12             1414
XTSE   491  2.080540e+12              230
2025-01-20 16:36:40,498 - Review.reviews.edwpt_review - INFO - Saving output to: C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\output\EDWPT_df_20250120_163640.xlsx
2025-01-20 16:36:40,803 - Review.reviews.edwpt_review - ERROR - Error saving output file: 'Isin Code'
2025-01-20 16:36:40,807 - Review.reviews.edwpt_review - ERROR - Traceback (most recent call last):
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Isin Code'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\Review\reviews\edwpt_review.py", line 347, in run_edwpt_review
    inclusions_df, exclusions_df = analyze_changes(
                                   ^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\Review\reviews\edwpt_review.py", line 212, in analyze_changes
    current_isins = set(index_eod_df[index_eod_df['MIC'] == group_name]['Isin Code'].unique().tolist())
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Isin Code'

2025-01-20 16:36:40,819 - werkzeug - INFO - 127.0.0.1 - - [20/Jan/2025 16:36:40] "POST /calculate HTTP/1.1" 200 -
2025-01-20 16:37:58,649 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\OneDrive - Euronext\\Documents\\Projects\\GUI + Reviews\\Review\\reviews\\edwpt_review.py', reloading
2025-01-20 16:37:58,655 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\OneDrive - Euronext\\Documents\\Projects\\GUI + Reviews\\Review\\reviews\\edwpt_review.py', reloading
2025-01-20 16:37:58,656 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\OneDrive - Euronext\\Documents\\Projects\\GUI + Reviews\\Review\\reviews\\edwpt_review.py', reloading
