2025-04-10 19:10:19,565 - werkzeug - WARNING -  * Debugger is active!
2025-04-10 19:10:19,567 - werkzeug - INFO -  * Debugger PIN: 691-175-853
2025-04-10 19:10:19,795 - Review.reviews.lc100_review - INFO - Loading EOD data...
2025-04-10 19:10:20,421 - Review.reviews.lc100_review - INFO - Loading reference data...
2025-04-10 19:10:30,180 - Review.reviews.lc100_review - WARNING - Removed 18750 duplicate rows from cdp_climate_df
2025-04-10 19:10:30,183 - Review.reviews.lc100_review - INFO - Filtering universe for EU500 companies...
2025-04-10 19:10:30,184 - Review.reviews.lc100_review - INFO - Universe size after EU500 filter: 499
2025-04-10 19:10:30,190 - Review.reviews.lc100_review - INFO - Adding Free Float data...
2025-04-10 19:10:30,193 - Review.reviews.lc100_review - INFO - Adding ICB Subsector data...
2025-04-10 19:10:30,208 - Review.reviews.lc100_review - WARNING - Removed 9316 duplicate rows from ICB data
2025-04-10 19:10:30,292 - Review.reviews.lc100_review - INFO - Debug file saved to C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\debug\universe_df_after_nace_20250410_191030.xlsx
2025-04-10 19:10:30,292 - Review.reviews.lc100_review - INFO - Adding CDP Climate data...
2025-04-10 19:10:30,297 - Review.reviews.lc100_review - INFO - Adding Oekom Trust & Carbon data...
2025-04-10 19:10:30,300 - Review.reviews.lc100_review - INFO - Adding NACE data...
2025-04-10 19:10:30,302 - Review.reviews.lc100_review - INFO - Adding EU Taxonomy flag...
2025-04-10 19:10:30,303 - Review.reviews.lc100_review - INFO - Checking GAFI lists and Non-fiscally cooperative countries...
2025-04-10 19:10:30,304 - Review.reviews.lc100_review - INFO - Applying exclusion criteria...
2025-04-10 19:10:30,311 - Review.reviews.lc100_review - INFO - Marked 50 companies (10%) with worst SG scores for exclusion
2025-04-10 19:10:30,330 - Review.reviews.lc100_review - INFO - Calculating Climate Score for ranking...
2025-04-10 19:10:30,331 - Review.reviews.lc100_review - INFO - Selecting EU Taxonomy companies...
2025-04-10 19:10:30,332 - Review.reviews.lc100_review - INFO - Found 14 EU Taxonomy companies after exclusions
2025-04-10 19:10:30,334 - Review.reviews.lc100_review - INFO - Found 302 Non-EU Taxonomy eligible companies after exclusions
2025-04-10 19:10:30,334 - Review.reviews.lc100_review - INFO - STEP 4a: Determining target number of Non-EU Taxonomy companies per super-sector...
2025-04-10 19:10:30,334 - Review.reviews.lc100_review - INFO - Target number of Non-EU Taxonomy companies: 86
2025-04-10 19:10:30,335 - Review.reviews.lc100_review - INFO - Total eligible Non-EU Taxonomy companies: 302
2025-04-10 19:10:30,336 - Review.reviews.lc100_review - INFO - Total target after rounding: 96 (vs. target of 86)
2025-04-10 19:10:30,336 - Review.reviews.lc100_review - INFO - Need to remove 10 companies due to rounding up
2025-04-10 19:10:30,337 - Review.reviews.lc100_review - INFO - STEP 4b: Selecting Non-EU Taxonomy companies based on climate score...
2025-04-10 19:10:30,338 - Review.reviews.lc100_review - ERROR - Error during review calculation: cannot do positional indexing on Index with these indexers [4.0] of type float64
2025-04-10 19:10:30,341 - Review.reviews.lc100_review - ERROR - Traceback (most recent call last):
  File "C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\Review\reviews\lc100_review.py", line 607, in run_lc100_review
    selected = supersector_companies.head(target_count)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\generic.py", line 5893, in head
    return self.iloc[:n]
           ~~~~~~~~~^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexing.py", line 1729, in _getitem_axis
    return self._get_slice_axis(key, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexing.py", line 1764, in _get_slice_axis
    labels._validate_positional_slice(slice_obj)
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexes\base.py", line 4198, in _validate_positional_slice
    self._validate_indexer("positional", key.stop, "iloc")
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexes\base.py", line 6697, in _validate_indexer
    self._raise_invalid_indexer(form, key)
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexes\base.py", line 4301, in _raise_invalid_indexer
    raise TypeError(msg)
TypeError: cannot do positional indexing on Index with these indexers [4.0] of type float64

2025-04-10 19:10:30,372 - werkzeug - INFO - 127.0.0.1 - - [10/Apr/2025 19:10:30] "POST /calculate HTTP/1.1" 200 -
