2025-02-10 15:04:55,269 - werkzeug - WARNING -  * Debugger is active!
2025-02-10 15:04:55,272 - werkzeug - INFO -  * Debugger PIN: 691-175-853
2025-02-10 15:05:07,807 - Review.reviews.edwp_review - INFO - Starting EDWP review calculation
2025-02-10 15:05:12,926 - Review.reviews.edwp_review - INFO - 
EDWP Selection Summary:
2025-02-10 15:05:12,928 - Review.reviews.edwp_review - INFO - Total companies selected: 5446
2025-02-10 15:05:12,930 - Review.reviews.edwp_review - INFO - Total FFMC covered: 98.84%
2025-02-10 15:05:12,955 - Review.reviews.edwp_review - INFO - 
DEUP Selection Summary:
2025-02-10 15:05:12,957 - Review.reviews.edwp_review - INFO - Total companies selected: 1327
2025-02-10 15:05:12,959 - Review.reviews.edwp_review - INFO - Total FFMC covered: 98.67%
2025-02-10 15:05:12,975 - Review.reviews.edwp_review - INFO - 
DEZP Selection Summary:
2025-02-10 15:05:12,976 - Review.reviews.edwp_review - INFO - Total companies selected: 494
2025-02-10 15:05:12,977 - Review.reviews.edwp_review - INFO - Total FFMC covered: 98.51%
2025-02-10 15:05:12,994 - Review.reviews.edwp_review - INFO - 
DAPPR Selection Summary:
2025-02-10 15:05:12,995 - Review.reviews.edwp_review - INFO - Total companies selected: 1909
2025-02-10 15:05:12,997 - Review.reviews.edwp_review - INFO - Total FFMC covered: 98.13%
2025-02-10 15:05:13,009 - Review.reviews.edwp_review - INFO - 
DNAP Selection Summary:
2025-02-10 15:05:13,011 - Review.reviews.edwp_review - INFO - Total companies selected: 1764
2025-02-10 15:05:13,012 - Review.reviews.edwp_review - INFO - Total FFMC covered: 98.18%
2025-02-10 15:05:13,025 - Review.reviews.edwp_review - INFO - 
DASP Selection Summary:
2025-02-10 15:05:13,026 - Review.reviews.edwp_review - INFO - Total companies selected: 1563
2025-02-10 15:05:13,028 - Review.reviews.edwp_review - INFO - Total FFMC covered: 98.07%
2025-02-10 15:05:13,034 - Review.reviews.edwp_review - INFO - 
DPAP Selection Summary:
2025-02-10 15:05:13,035 - Review.reviews.edwp_review - INFO - Total companies selected: 320
2025-02-10 15:05:13,036 - Review.reviews.edwp_review - INFO - Total FFMC covered: 98.04%
2025-02-10 15:05:13,046 - Review.reviews.edwp_review - INFO - 
EUSP Selection Summary:
2025-02-10 15:05:13,048 - Review.reviews.edwp_review - INFO - Total companies selected: 1481
2025-02-10 15:05:13,049 - Review.reviews.edwp_review - INFO - Total FFMC covered: 98.00%
2025-02-10 15:05:13,059 - Review.reviews.edwp_review - INFO - 
EJPP Selection Summary:
2025-02-10 15:05:13,060 - Review.reviews.edwp_review - INFO - Total companies selected: 1414
2025-02-10 15:05:13,061 - Review.reviews.edwp_review - INFO - Total FFMC covered: 98.00%
2025-02-10 15:05:13,066 - Review.reviews.edwp_review - INFO - 
ECHP Selection Summary:
2025-02-10 15:05:13,067 - Review.reviews.edwp_review - INFO - Total companies selected: 74
2025-02-10 15:05:13,068 - Review.reviews.edwp_review - INFO - Total FFMC covered: 98.05%
2025-02-10 15:05:13,073 - Review.reviews.edwp_review - INFO - 
EUKP Selection Summary:
2025-02-10 15:05:13,074 - Review.reviews.edwp_review - INFO - Total companies selected: 320
2025-02-10 15:05:13,075 - Review.reviews.edwp_review - INFO - Total FFMC covered: 98.01%
2025-02-10 15:05:13,080 - Review.reviews.edwp_review - INFO - 
CANP Selection Summary:
2025-02-10 15:05:13,081 - Review.reviews.edwp_review - INFO - Total companies selected: 230
2025-02-10 15:05:13,082 - Review.reviews.edwp_review - INFO - Total FFMC covered: 98.02%
2025-02-10 15:05:13,092 - Review.reviews.edwp_review - INFO - 
Global Selection Summary:
2025-02-10 15:05:13,092 - Review.reviews.edwp_review - INFO - Total companies selected: 5446
2025-02-10 15:05:13,094 - Review.reviews.edwp_review - INFO - Total FFMC covered: 98.84%
2025-02-10 15:05:13,097 - Review.reviews.edwp_review - INFO - 
MIC-level Summary:
2025-02-10 15:05:13,097 - Review.reviews.edwp_review - INFO -       ISIN          FFMC  EDWP_selection
MIC                                     
ALXP     1  1.337544e+09               1
BATS     3  1.962934e+10               1
MERK     2  2.803735e+08               2
MTAA   246  5.292374e+11              85
WBAH    26  5.370078e+10              17
XAMS    79  1.157401e+12              44
XASX   886  1.442942e+12             283
XBRU    58  1.938564e+11              34
XCSE   107  6.350474e+11              36
XESM     2  1.794035e+09               2
XETR   227  1.472409e+12             106
XHEL   127  2.061674e+11              49
XHKG   209  3.465502e+11              69
XLIS    18  3.541669e+10              11
XLON   872  2.336733e+12             320
XMAD    99  4.808796e+11              41
XMSM    14  5.274635e+10              10
XNGM    47  4.908139e+08               1
XNGS  2628  2.418978e+13             773
XNYS  1736  2.534917e+13            1143
XNZE    52  6.656698e+10              35
XOSL   245  1.738210e+11             125
XPAR   351  1.866583e+12              94
XSES   118  2.570802e+11              62
XSTO   648  7.073552e+11             222
XSWX   148  1.669679e+12              86
XTAE   275  1.399417e+11             150
XTKS  3711  4.991981e+12            1414
XTSE   491  2.080540e+12             230
2025-02-10 15:05:13,118 - Review.reviews.edwp_review - INFO - Saving output to: C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\output\EDWP_df_20250210_150513.xlsx
2025-02-10 15:05:13,446 - Review.reviews.edwp_review - ERROR - Error saving output file: 'Type'
2025-02-10 15:05:13,449 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\AppData\\Roaming\\Python\\Python312\\site-packages\\pandas\\core\\frame.py', reloading
2025-02-10 15:05:13,450 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\AppData\\Roaming\\Python\\Python312\\site-packages\\pandas\\core\\indexes\\base.py', reloading
2025-02-10 15:05:13,451 - Review.reviews.edwp_review - ERROR - Traceback (most recent call last):
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Type'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\Review\reviews\edwp_review.py", line 283, in run_edwp_review
    (stock_eod_df['Type'] == 'STOCK')
     ~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Type'

2025-02-10 15:05:13,464 - werkzeug - INFO - 127.0.0.1 - - [10/Feb/2025 15:05:13] "POST /calculate HTTP/1.1" 200 -
