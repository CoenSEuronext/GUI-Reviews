2025-07-25 11:12:30,747 - werkzeug - WARNING -  * Debugger is active!
2025-07-25 11:12:30,747 - werkzeug - INFO -  * Debugger PIN: 691-175-853
2025-07-25 11:12:30,874 - Review.reviews.eus5p_review - INFO - Loading EOD data...
2025-07-25 11:12:32,896 - Review.reviews.eus5p_review - INFO - Loading reference data...
2025-07-25 11:12:40,604 - Review.reviews.eus5p_review - INFO - Common columns (11): ['12 month aver. turnover EUR', '20 days aver. turn EUR', '3 months aver. Turnover USD', '6 month aver. turnover EUR', 'Currency', 'ISIN', 'NOSH', 'Name', 'Price', 'Rank', 'Ticker']
2025-07-25 11:12:40,604 - Review.reviews.eus5p_review - INFO - Eurozone-only columns (8): ['10 days aver. turn EUR', '100 days aver. turn EUR', '100 days volatility', '126 days volatility', '180 days volatility', '3 months aver. Turnover EUR', '5 days aver. turn EUR', 'MIC']
2025-07-25 11:12:40,604 - Review.reviews.eus5p_review - INFO - North America-only columns (3): ['3 month aver. turnover EUR', 'Exchange Name (VND)', 'Sec Market Value (EUR)']
2025-07-25 11:12:40,604 - Review.reviews.eus5p_review - INFO - Final column order will be: ['Rank', 'Ticker', 'Name', 'ISIN', 'MIC', 'NOSH', 'Price', 'Currency', '12 month aver. turnover EUR', '20 days aver. turn EUR', '10 days aver. turn EUR', '5 days aver. turn EUR', '6 month aver. turnover EUR', '126 days volatility', '100 days volatility', '100 days aver. turn EUR', '180 days volatility', '3 months aver. Turnover EUR', '3 months aver. Turnover USD', 'Exchange Name (VND)', 'Sec Market Value (EUR)', '3 month aver. turnover EUR']
2025-07-25 11:12:40,604 - Review.reviews.eus5p_review - INFO - Total columns in combined DataFrame: 22
2025-07-25 11:12:40,695 - Review.reviews.eus5p_review - ERROR - Error during review calculation: 'Exclusion_Reason'
2025-07-25 11:12:40,696 - Review.reviews.eus5p_review - ERROR - Traceback (most recent call last):
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'Exclusion_Reason'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\Review\reviews\eus5p_review.py", line 148, in run_eus5p_review
    excluded_count = len(selection_df[selection_df['Exclusion_Reason'] != ''])
                                      ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'Exclusion_Reason'

2025-07-25 11:12:40,712 - werkzeug - INFO - 127.0.0.1 - - [25/Jul/2025 11:12:40] "POST /calculate HTTP/1.1" 200 -
2025-07-25 11:12:52,275 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\AppData\\Roaming\\Python\\Python312\\site-packages\\pandas\\core\\series.py', reloading
2025-07-25 11:12:52,330 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\AppData\\Roaming\\Python\\Python312\\site-packages\\pandas\\core\\arraylike.py', reloading
