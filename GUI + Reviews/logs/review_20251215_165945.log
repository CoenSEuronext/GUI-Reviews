2025-12-15 16:59:46,105 - werkzeug - WARNING -  * Debugger is active!
2025-12-15 16:59:46,105 - werkzeug - INFO -  * Debugger PIN: 691-175-853
2025-12-15 16:59:46,135 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 16:59:46] "GET /task-status/c4ca99ac-f3d4-4c29-95bf-3b0d9933bcb4 HTTP/1.1" 200 -
2025-12-15 16:59:49,696 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 16:59:49] "POST /calculate HTTP/1.1" 200 -
2025-12-15 16:59:49,698 - Review.reviews.frd4p_review - INFO - Loading EOD data...
2025-12-15 16:59:49,702 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 16:59:49] "GET /task-status/de896bf7-57c3-4ea4-a0c9-e494b04a472d HTTP/1.1" 200 -
2025-12-15 16:59:50,183 - Review.reviews.frd4p_review - INFO - Loading reference data...
2025-12-15 16:59:51,712 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 16:59:51] "GET /task-status/de896bf7-57c3-4ea4-a0c9-e494b04a472d HTTP/1.1" 200 -
2025-12-15 16:59:53,707 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 16:59:53] "GET /task-status/de896bf7-57c3-4ea4-a0c9-e494b04a472d HTTP/1.1" 200 -
2025-12-15 16:59:55,707 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 16:59:55] "GET /task-status/de896bf7-57c3-4ea4-a0c9-e494b04a472d HTTP/1.1" 200 -
2025-12-15 16:59:57,703 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 16:59:57] "GET /task-status/de896bf7-57c3-4ea4-a0c9-e494b04a472d HTTP/1.1" 200 -
2025-12-15 16:59:59,708 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 16:59:59] "GET /task-status/de896bf7-57c3-4ea4-a0c9-e494b04a472d HTTP/1.1" 200 -
2025-12-15 17:00:01,710 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 17:00:01] "GET /task-status/de896bf7-57c3-4ea4-a0c9-e494b04a472d HTTP/1.1" 200 -
2025-12-15 17:00:01,788 - Review.reviews.frd4p_review - INFO - Merging all reference data points early...
2025-12-15 17:00:01,788 - Review.reviews.frd4p_review - INFO - Merging Oekom data...
2025-12-15 17:00:01,793 - Review.reviews.frd4p_review - INFO - Merging NACE data...
2025-12-15 17:00:01,796 - Review.reviews.frd4p_review - INFO - Merging ICB data...
2025-12-15 17:00:01,930 - Review.reviews.frd4p_review - INFO - Merging SesamM data...
2025-12-15 17:00:01,970 - Review.reviews.frd4p_review - INFO - Converting numeric columns...
2025-12-15 17:00:02,069 - Review.reviews.frd4p_review - INFO - All reference data merged successfully
2025-12-15 17:00:02,069 - Review.reviews.frd4p_review - INFO - Universe size after merges: 158509 companies
2025-12-15 17:00:02,069 - Review.reviews.frd4p_review - INFO - Applying currency exclusion...
2025-12-15 17:00:02,141 - Review.reviews.frd4p_review - INFO - Currency exclusions: 156433
2025-12-15 17:00:02,141 - Review.reviews.frd4p_review - INFO - Applying SesamM data availability exclusion...
2025-12-15 17:00:02,213 - Review.reviews.frd4p_review - INFO - SesamM data unavailable exclusions: 157901
2025-12-15 17:00:02,213 - Review.reviews.frd4p_review - INFO - Applying turnover exclusion...
2025-12-15 17:00:02,213 - Review.reviews.frd4p_review - INFO - Turnover exclusions: 259
2025-12-15 17:00:02,213 - Review.reviews.frd4p_review - INFO - Applying NBR Overall Flag exclusion...
2025-12-15 17:00:02,223 - Review.reviews.frd4p_review - INFO - NBR Overall Flag exclusions: 3
2025-12-15 17:00:02,224 - Review.reviews.frd4p_review - INFO - Applying controversial weapons exclusions...
2025-12-15 17:00:02,229 - Review.reviews.frd4p_review - INFO - BiologicalWeapons exclusions: 0
2025-12-15 17:00:02,235 - Review.reviews.frd4p_review - INFO - ChemicalWeapons exclusions: 0
2025-12-15 17:00:02,240 - Review.reviews.frd4p_review - INFO - NuclearWeapons exclusions: 82
2025-12-15 17:00:02,245 - Review.reviews.frd4p_review - INFO - NuclearWeaponsNonNPT exclusions: 1
2025-12-15 17:00:02,246 - Review.reviews.frd4p_review - INFO - ClusterMunitions exclusions: 13
2025-12-15 17:00:02,257 - Review.reviews.frd4p_review - INFO - DepletedUranium exclusions: 12
2025-12-15 17:00:02,258 - Review.reviews.frd4p_review - INFO - APMines exclusions: 11
2025-12-15 17:00:02,269 - Review.reviews.frd4p_review - INFO - WhitePhosphorus exclusions: 15
2025-12-15 17:00:02,269 - Review.reviews.frd4p_review - INFO - Applying coal mining exclusion...
2025-12-15 17:00:02,271 - Review.reviews.frd4p_review - INFO - Coal Mining exclusions: 129
2025-12-15 17:00:02,271 - Review.reviews.frd4p_review - INFO - Applying fossil fuel exclusion...
2025-12-15 17:00:02,279 - Review.reviews.frd4p_review - INFO - Fossil Fuel exclusions: 226
2025-12-15 17:00:02,279 - Review.reviews.frd4p_review - INFO - Applying thermal power exclusion...
2025-12-15 17:00:02,281 - Review.reviews.frd4p_review - INFO - Thermal Power exclusions: 11
2025-12-15 17:00:02,281 - Review.reviews.frd4p_review - INFO - Applying SBT alignment exclusion...
2025-12-15 17:00:02,291 - Review.reviews.frd4p_review - INFO - SBT alignment exclusions: 0
2025-12-15 17:00:02,291 - Review.reviews.frd4p_review - INFO - Applying tobacco production exclusion...
2025-12-15 17:00:02,300 - Review.reviews.frd4p_review - INFO - Tobacco Production exclusions: 15
2025-12-15 17:00:02,300 - Review.reviews.frd4p_review - INFO - Applying tobacco distribution exclusion...
2025-12-15 17:00:02,304 - Review.reviews.frd4p_review - INFO - Tobacco Distribution exclusions: 3
2025-12-15 17:00:02,304 - Review.reviews.frd4p_review - INFO - Applying layoff screening exclusion...
2025-12-15 17:00:02,310 - Review.reviews.frd4p_review - INFO - Layoff exclusions: 18
2025-12-15 17:00:02,310 - Review.reviews.frd4p_review - INFO - Applying staff rating exclusion...
2025-12-15 17:00:02,404 - Review.reviews.frd4p_review - INFO - Staff Rating exclusions: 473
2025-12-15 17:00:03,763 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 17:00:03] "GET /task-status/de896bf7-57c3-4ea4-a0c9-e494b04a472d HTTP/1.1" 200 -
2025-12-15 17:00:05,797 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 17:00:05] "GET /task-status/de896bf7-57c3-4ea4-a0c9-e494b04a472d HTTP/1.1" 200 -
2025-12-15 17:00:06,120 - Review.reviews.frd4p_review - INFO - Companies remaining after exclusions: 314
2025-12-15 17:00:06,120 - Review.reviews.frd4p_review - INFO - Eligible companies - XPAR: 81, Non-XPAR: 233
2025-12-15 17:00:06,130 - Review.reviews.frd4p_review - ERROR - Error during review calculation: Length of values (2) does not match length of index (314)
2025-12-15 17:00:06,136 - Review.reviews.frd4p_review - ERROR - Traceback (most recent call last):
  File "C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\Review\reviews\frd4p_review.py", line 539, in run_frd4p_review
    selection_df['Combined Rank'] = selection_df.groupby('MIC_Type').apply(
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\frame.py", line 4311, in __setitem__
    self._set_item(key, value)
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\frame.py", line 4524, in _set_item
    value, refs = self._sanitize_column(value)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\frame.py", line 5266, in _sanitize_column
    com.require_length_match(value, self.index)
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\common.py", line 573, in require_length_match
    raise ValueError(
ValueError: Length of values (2) does not match length of index (314)

2025-12-15 17:00:07,705 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 17:00:07] "GET /task-status/de896bf7-57c3-4ea4-a0c9-e494b04a472d HTTP/1.1" 200 -
2025-12-15 17:00:22,322 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 17:00:22] "POST /calculate HTTP/1.1" 200 -
2025-12-15 17:00:22,322 - Review.reviews.frd4p_review - INFO - Loading EOD data...
2025-12-15 17:00:22,322 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 17:00:22] "GET /task-status/a3598c01-50c9-4962-890a-2e257fcb2f71 HTTP/1.1" 200 -
2025-12-15 17:00:22,780 - Review.reviews.frd4p_review - INFO - Loading reference data...
2025-12-15 17:00:24,341 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 17:00:24] "GET /task-status/a3598c01-50c9-4962-890a-2e257fcb2f71 HTTP/1.1" 200 -
2025-12-15 17:00:26,331 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 17:00:26] "GET /task-status/a3598c01-50c9-4962-890a-2e257fcb2f71 HTTP/1.1" 200 -
2025-12-15 17:00:28,360 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 17:00:28] "GET /task-status/a3598c01-50c9-4962-890a-2e257fcb2f71 HTTP/1.1" 200 -
2025-12-15 17:00:30,333 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 17:00:30] "GET /task-status/a3598c01-50c9-4962-890a-2e257fcb2f71 HTTP/1.1" 200 -
2025-12-15 17:00:32,338 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 17:00:32] "GET /task-status/a3598c01-50c9-4962-890a-2e257fcb2f71 HTTP/1.1" 200 -
2025-12-15 17:00:34,198 - Review.reviews.frd4p_review - INFO - Merging all reference data points early...
2025-12-15 17:00:34,198 - Review.reviews.frd4p_review - INFO - Merging Oekom data...
2025-12-15 17:00:34,202 - Review.reviews.frd4p_review - INFO - Merging NACE data...
2025-12-15 17:00:34,207 - Review.reviews.frd4p_review - INFO - Merging ICB data...
2025-12-15 17:00:34,332 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 17:00:34] "GET /task-status/a3598c01-50c9-4962-890a-2e257fcb2f71 HTTP/1.1" 200 -
2025-12-15 17:00:34,346 - Review.reviews.frd4p_review - INFO - Merging SesamM data...
2025-12-15 17:00:34,407 - Review.reviews.frd4p_review - INFO - Converting numeric columns...
2025-12-15 17:00:34,498 - Review.reviews.frd4p_review - INFO - All reference data merged successfully
2025-12-15 17:00:34,498 - Review.reviews.frd4p_review - INFO - Universe size after merges: 158509 companies
2025-12-15 17:00:34,498 - Review.reviews.frd4p_review - INFO - Applying currency exclusion...
2025-12-15 17:00:34,566 - Review.reviews.frd4p_review - INFO - Currency exclusions: 156433
2025-12-15 17:00:34,566 - Review.reviews.frd4p_review - INFO - Applying SesamM data availability exclusion...
2025-12-15 17:00:34,640 - Review.reviews.frd4p_review - INFO - SesamM data unavailable exclusions: 157901
2025-12-15 17:00:34,640 - Review.reviews.frd4p_review - INFO - Applying turnover exclusion...
2025-12-15 17:00:34,644 - Review.reviews.frd4p_review - INFO - Turnover exclusions: 259
2025-12-15 17:00:34,644 - Review.reviews.frd4p_review - INFO - Applying NBR Overall Flag exclusion...
2025-12-15 17:00:34,650 - Review.reviews.frd4p_review - INFO - NBR Overall Flag exclusions: 3
2025-12-15 17:00:34,651 - Review.reviews.frd4p_review - INFO - Applying controversial weapons exclusions...
2025-12-15 17:00:34,657 - Review.reviews.frd4p_review - INFO - BiologicalWeapons exclusions: 0
2025-12-15 17:00:34,663 - Review.reviews.frd4p_review - INFO - ChemicalWeapons exclusions: 0
2025-12-15 17:00:34,668 - Review.reviews.frd4p_review - INFO - NuclearWeapons exclusions: 82
2025-12-15 17:00:34,673 - Review.reviews.frd4p_review - INFO - NuclearWeaponsNonNPT exclusions: 1
2025-12-15 17:00:34,680 - Review.reviews.frd4p_review - INFO - ClusterMunitions exclusions: 13
2025-12-15 17:00:34,682 - Review.reviews.frd4p_review - INFO - DepletedUranium exclusions: 12
2025-12-15 17:00:34,694 - Review.reviews.frd4p_review - INFO - APMines exclusions: 11
2025-12-15 17:00:34,700 - Review.reviews.frd4p_review - INFO - WhitePhosphorus exclusions: 15
2025-12-15 17:00:34,700 - Review.reviews.frd4p_review - INFO - Applying coal mining exclusion...
2025-12-15 17:00:34,705 - Review.reviews.frd4p_review - INFO - Coal Mining exclusions: 129
2025-12-15 17:00:34,705 - Review.reviews.frd4p_review - INFO - Applying fossil fuel exclusion...
2025-12-15 17:00:34,710 - Review.reviews.frd4p_review - INFO - Fossil Fuel exclusions: 226
2025-12-15 17:00:34,710 - Review.reviews.frd4p_review - INFO - Applying thermal power exclusion...
2025-12-15 17:00:34,712 - Review.reviews.frd4p_review - INFO - Thermal Power exclusions: 11
2025-12-15 17:00:34,712 - Review.reviews.frd4p_review - INFO - Applying SBT alignment exclusion...
2025-12-15 17:00:34,727 - Review.reviews.frd4p_review - INFO - SBT alignment exclusions: 0
2025-12-15 17:00:34,727 - Review.reviews.frd4p_review - INFO - Applying tobacco production exclusion...
2025-12-15 17:00:34,729 - Review.reviews.frd4p_review - INFO - Tobacco Production exclusions: 15
2025-12-15 17:00:34,731 - Review.reviews.frd4p_review - INFO - Applying tobacco distribution exclusion...
2025-12-15 17:00:34,731 - Review.reviews.frd4p_review - INFO - Tobacco Distribution exclusions: 3
2025-12-15 17:00:34,731 - Review.reviews.frd4p_review - INFO - Applying layoff screening exclusion...
2025-12-15 17:00:34,741 - Review.reviews.frd4p_review - INFO - Layoff exclusions: 18
2025-12-15 17:00:34,741 - Review.reviews.frd4p_review - INFO - Applying staff rating exclusion...
2025-12-15 17:00:34,840 - Review.reviews.frd4p_review - INFO - Staff Rating exclusions: 473
2025-12-15 17:00:36,381 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 17:00:36] "GET /task-status/a3598c01-50c9-4962-890a-2e257fcb2f71 HTTP/1.1" 200 -
2025-12-15 17:00:38,365 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 17:00:38] "GET /task-status/a3598c01-50c9-4962-890a-2e257fcb2f71 HTTP/1.1" 200 -
2025-12-15 17:00:38,655 - Review.reviews.frd4p_review - INFO - Companies remaining after exclusions: 314
2025-12-15 17:00:38,655 - Review.reviews.frd4p_review - INFO - Eligible companies - XPAR: 81, Non-XPAR: 233
2025-12-15 17:00:38,655 - Review.reviews.frd4p_review - ERROR - Error during review calculation: Length of values (2) does not match length of index (314)
2025-12-15 17:00:38,662 - Review.reviews.frd4p_review - ERROR - Traceback (most recent call last):
  File "C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\Review\reviews\frd4p_review.py", line 539, in run_frd4p_review
    selection_df['Combined Rank'] = selection_df.groupby('MIC_Type').apply(
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\frame.py", line 4311, in __setitem__
    self._set_item(key, value)
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\frame.py", line 4524, in _set_item
    value, refs = self._sanitize_column(value)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\frame.py", line 5266, in _sanitize_column
    com.require_length_match(value, self.index)
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\common.py", line 573, in require_length_match
    raise ValueError(
ValueError: Length of values (2) does not match length of index (314)

2025-12-15 17:00:40,333 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 17:00:40] "GET /task-status/a3598c01-50c9-4962-890a-2e257fcb2f71 HTTP/1.1" 200 -
2025-12-15 17:00:49,302 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\OneDrive - Euronext\\Documents\\Projects\\GUI + Reviews\\Review\\reviews\\frd4p_review.py', reloading
2025-12-15 17:00:49,302 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\OneDrive - Euronext\\Documents\\Projects\\GUI + Reviews\\Review\\reviews\\frd4p_review.py', reloading
2025-12-15 17:00:49,306 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\OneDrive - Euronext\\Documents\\Projects\\GUI + Reviews\\Review\\reviews\\frd4p_review.py', reloading
2025-12-15 17:00:49,312 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\OneDrive - Euronext\\Documents\\Projects\\GUI + Reviews\\Review\\reviews\\frd4p_review.py', reloading
2025-12-15 17:00:49,489 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\OneDrive - Euronext\\Documents\\Projects\\GUI + Reviews\\Review\\reviews\\frd4p_review.py', reloading
2025-12-15 17:00:49,489 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\OneDrive - Euronext\\Documents\\Projects\\GUI + Reviews\\Review\\reviews\\frd4p_review.py', reloading
2025-12-15 17:00:49,489 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\OneDrive - Euronext\\Documents\\Projects\\GUI + Reviews\\Review\\reviews\\frd4p_review.py', reloading
