2026-02-11 17:34:30,570 - Review.reviews.ezgp_review - INFO - Loading EOD data...
2026-02-11 17:34:31,508 - Review.reviews.ezgp_review - INFO - Loading reference data...
2026-02-11 17:34:31,596 - Review.reviews.ezgp_review - INFO - Starting universe size: 300
2026-02-11 17:34:31,677 - Review.reviews.ezgp_review - INFO - Step 2.1: Filtering by 3-month Average Daily Traded Value...
2026-02-11 17:34:31,678 - Review.reviews.ezgp_review - INFO - After ADTV filter (>= 40,000,000 EUR): 105 companies (excluded 195)
2026-02-11 17:34:31,678 - Review.reviews.ezgp_review - INFO - Step 2.2: Carbon Emission Data filter - skipped for now
2026-02-11 17:34:31,678 - Review.reviews.ezgp_review - INFO - Step 2.3: Filtering to Eurozone countries...
2026-02-11 17:34:31,679 - Review.reviews.ezgp_review - INFO - After Eurozone filter: 102 companies
2026-02-11 17:34:31,679 - Review.reviews.ezgp_review - INFO - Merging Sustainalytics data...
2026-02-11 17:34:31,684 - Review.reviews.ezgp_review - INFO - Sustainalytics merge completed. Added 28 columns.
2026-02-11 17:34:31,684 - Review.reviews.ezgp_review - INFO - Applying exclusion criteria...
2026-02-11 17:34:31,690 - Review.reviews.ezgp_review - INFO - Exclusion criteria applied. 102 companies excluded.
2026-02-11 17:34:31,691 - Review.reviews.ezgp_review - INFO - After exclusions: 0 companies eligible
2026-02-11 17:34:31,691 - Review.reviews.ezgp_review - INFO - Step 2.6: Ranking by ESG Risk Score (lower is better)...
2026-02-11 17:34:31,691 - Review.reviews.ezgp_review - WARNING - ESG Risk Score (181110112399) not available. Skipping ESG ranking.
2026-02-11 17:34:31,691 - Review.reviews.ezgp_review - INFO - Step 2.7: Selecting top 40 companies with lowest ESG Risk Score...
2026-02-11 17:34:31,691 - Review.reviews.ezgp_review - INFO - Pre-selection: 0 companies
2026-02-11 17:34:31,691 - Review.reviews.ezgp_review - INFO - Step 3: Ranking pre-selected companies by FFMC...
2026-02-11 17:34:31,691 - Review.reviews.ezgp_review - INFO - Step 4: Selecting top 20 companies with max 5 per Industry Code...
2026-02-11 17:34:31,693 - Review.reviews.ezgp_review - INFO - Final selection: 0 companies
2026-02-11 17:34:31,693 - Review.reviews.ezgp_review - INFO - Industry distribution: {}
2026-02-11 17:34:31,693 - Review.reviews.ezgp_review - INFO - Applying 10% capping using most recent pricing data...
2026-02-11 17:34:31,693 - Review.reviews.ezgp_review - ERROR - Error during review calculation: DataFrame is empty or all market cap values are NaN
2026-02-11 17:34:31,694 - Review.reviews.ezgp_review - ERROR - Traceback (most recent call last):
  File "C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\Review\reviews\ezgp_review.py", line 514, in run_ezgp_review
    final_selection_df = apply_proportional_capping(
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\utils\capping_proportional.py", line 43, in apply_proportional_capping
    raise ValueError("DataFrame is empty or all market cap values are NaN")
ValueError: DataFrame is empty or all market cap values are NaN

