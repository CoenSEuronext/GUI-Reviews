2025-12-15 18:45:03,765 - werkzeug - WARNING -  * Debugger is active!
2025-12-15 18:45:03,772 - werkzeug - INFO -  * Debugger PIN: 691-175-853
2025-12-15 18:45:03,801 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 18:45:03] "POST /calculate HTTP/1.1" 200 -
2025-12-15 18:45:03,803 - Review.reviews.wifrp_review - INFO - Loading EOD data...
2025-12-15 18:45:03,806 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 18:45:03] "GET /task-status/b74b72a8-8054-4346-9615-863eafda0a55 HTTP/1.1" 200 -
2025-12-15 18:45:04,269 - Review.reviews.wifrp_review - INFO - Loading reference data...
2025-12-15 18:45:05,805 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 18:45:05] "GET /task-status/b74b72a8-8054-4346-9615-863eafda0a55 HTTP/1.1" 200 -
2025-12-15 18:45:07,805 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 18:45:07] "GET /task-status/b74b72a8-8054-4346-9615-863eafda0a55 HTTP/1.1" 200 -
2025-12-15 18:45:09,822 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 18:45:09] "GET /task-status/b74b72a8-8054-4346-9615-863eafda0a55 HTTP/1.1" 200 -
2025-12-15 18:45:11,806 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 18:45:11] "GET /task-status/b74b72a8-8054-4346-9615-863eafda0a55 HTTP/1.1" 200 -
2025-12-15 18:45:13,822 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 18:45:13] "GET /task-status/b74b72a8-8054-4346-9615-863eafda0a55 HTTP/1.1" 200 -
2025-12-15 18:45:15,772 - Review.reviews.wifrp_review - INFO - Filtering universe to exclude Euronext Paris (XPAR) listings...
2025-12-15 18:45:15,772 - Review.reviews.wifrp_review - INFO - Merging all reference data points early...
2025-12-15 18:45:15,772 - Review.reviews.wifrp_review - INFO - Deduplicating reference dataframes...
2025-12-15 18:45:15,795 - Review.reviews.wifrp_review - INFO - Merging Oekom data...
2025-12-15 18:45:15,800 - Review.reviews.wifrp_review - INFO - Merging ICB data...
2025-12-15 18:45:15,813 - werkzeug - INFO - 127.0.0.1 - - [15/Dec/2025 18:45:15] "GET /task-status/b74b72a8-8054-4346-9615-863eafda0a55 HTTP/1.1" 200 -
2025-12-15 18:45:15,822 - Review.reviews.wifrp_review - INFO - Merging SesamM data...
2025-12-15 18:45:15,823 - Review.reviews.wifrp_review - INFO - Calculating percentiles and rankings for staff rating...
2025-12-15 18:45:15,823 - Review.reviews.wifrp_review - ERROR - Error during review calculation: 'CRStaffRatingNum Numeric'
2025-12-15 18:45:15,839 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\AppData\\Roaming\\Python\\Python312\\site-packages\\pandas\\core\\indexing.py', reloading
2025-12-15 18:45:15,840 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\AppData\\Roaming\\Python\\Python312\\site-packages\\pandas\\core\\frame.py', reloading
2025-12-15 18:45:15,845 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\AppData\\Roaming\\Python\\Python312\\site-packages\\pandas\\core\\indexes\\base.py', reloading
2025-12-15 18:45:15,845 - Review.reviews.wifrp_review - ERROR - Traceback (most recent call last):
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 196, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7081, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\\_libs\\hashtable_class_helper.pxi", line 7089, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'CRStaffRatingNum Numeric'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\Review\reviews\wifrp_review.py", line 242, in run_wifrp_review
    group_data = developed_market_df.loc[group_indices, 'CRStaffRatingNum Numeric']
                 ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexing.py", line 1184, in __getitem__
    return self._getitem_tuple(key)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexing.py", line 1368, in _getitem_tuple
    return self._getitem_lowerdim(tup)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexing.py", line 1065, in _getitem_lowerdim
    section = self._getitem_axis(key, axis=i)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexing.py", line 1431, in _getitem_axis
    return self._get_label(key, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexing.py", line 1381, in _get_label
    return self.obj.xs(label, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\generic.py", line 4287, in xs
    return self[key]
           ~~~~^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\frame.py", line 4102, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\CSonneveld\AppData\Roaming\Python\Python312\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: 'CRStaffRatingNum Numeric'

