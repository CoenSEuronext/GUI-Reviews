2025-12-16 15:19:34,365 - werkzeug - WARNING -  * Debugger is active!
2025-12-16 15:19:34,367 - werkzeug - INFO -  * Debugger PIN: 691-175-853
2025-12-16 15:19:34,399 - werkzeug - INFO - 127.0.0.1 - - [16/Dec/2025 15:19:34] "POST /calculate HTTP/1.1" 200 -
2025-12-16 15:19:34,399 - Review.reviews.wifrp_review - INFO - Loading EOD data...
2025-12-16 15:19:34,399 - werkzeug - INFO - 127.0.0.1 - - [16/Dec/2025 15:19:34] "GET /task-status/2109eea1-d083-4c6c-9911-c0e2b89fda78 HTTP/1.1" 200 -
2025-12-16 15:19:34,880 - Review.reviews.wifrp_review - INFO - Loading reference data...
2025-12-16 15:19:36,426 - werkzeug - INFO - 127.0.0.1 - - [16/Dec/2025 15:19:36] "GET /task-status/2109eea1-d083-4c6c-9911-c0e2b89fda78 HTTP/1.1" 200 -
2025-12-16 15:19:38,407 - werkzeug - INFO - 127.0.0.1 - - [16/Dec/2025 15:19:38] "GET /task-status/2109eea1-d083-4c6c-9911-c0e2b89fda78 HTTP/1.1" 200 -
2025-12-16 15:19:40,414 - werkzeug - INFO - 127.0.0.1 - - [16/Dec/2025 15:19:40] "GET /task-status/2109eea1-d083-4c6c-9911-c0e2b89fda78 HTTP/1.1" 200 -
2025-12-16 15:19:42,430 - werkzeug - INFO - 127.0.0.1 - - [16/Dec/2025 15:19:42] "GET /task-status/2109eea1-d083-4c6c-9911-c0e2b89fda78 HTTP/1.1" 200 -
2025-12-16 15:19:44,413 - werkzeug - INFO - 127.0.0.1 - - [16/Dec/2025 15:19:44] "GET /task-status/2109eea1-d083-4c6c-9911-c0e2b89fda78 HTTP/1.1" 200 -
2025-12-16 15:19:46,413 - werkzeug - INFO - 127.0.0.1 - - [16/Dec/2025 15:19:46] "GET /task-status/2109eea1-d083-4c6c-9911-c0e2b89fda78 HTTP/1.1" 200 -
2025-12-16 15:19:46,489 - Review.reviews.wifrp_review - INFO - Filtering universe to exclude Euronext Paris (XPAR) listings...
2025-12-16 15:19:46,490 - Review.reviews.wifrp_review - INFO - Merging all reference data points early...
2025-12-16 15:19:46,491 - Review.reviews.wifrp_review - INFO - Deduplicating reference dataframes...
2025-12-16 15:19:46,512 - Review.reviews.wifrp_review - INFO - Merging Oekom data...
2025-12-16 15:19:46,517 - Review.reviews.wifrp_review - INFO - Merging ICB data...
2025-12-16 15:19:46,532 - Review.reviews.wifrp_review - INFO - Merging SesamM data...
2025-12-16 15:19:46,535 - Review.reviews.wifrp_review - INFO - Converting numeric columns...
2025-12-16 15:19:46,538 - Review.reviews.wifrp_review - INFO - Staff Rating distribution: Min=1.091, Max=4.0
2025-12-16 15:19:46,538 - Review.reviews.wifrp_review - INFO - Companies with staff rating = 4 (Missing or Not Collected): 43
2025-12-16 15:19:46,538 - Review.reviews.wifrp_review - INFO - All reference data merged successfully
2025-12-16 15:19:46,539 - Review.reviews.wifrp_review - INFO - Universe size after merges: 1465 companies
2025-12-16 15:19:46,539 - Review.reviews.wifrp_review - INFO - Calculating percentiles and rankings for staff rating...
2025-12-16 15:19:46,593 - Review.reviews.wifrp_review - INFO - Percentile and ranking calculations completed
2025-12-16 15:19:46,595 - Review.reviews.wifrp_review - INFO - Staff Rating Percentile range: 1.12 to 100.00
2025-12-16 15:19:46,595 - Review.reviews.wifrp_review - INFO - Companies with percentiles calculated: 1465
2025-12-16 15:19:46,595 - Review.reviews.wifrp_review - INFO - Applying SesamM data availability exclusion...
2025-12-16 15:19:46,597 - Review.reviews.wifrp_review - INFO - SesamM data unavailable exclusions: 1215
2025-12-16 15:19:46,598 - Review.reviews.wifrp_review - INFO - Applying turnover exclusion...
2025-12-16 15:19:46,598 - Review.reviews.wifrp_review - INFO - Turnover exclusions: 172
2025-12-16 15:19:46,598 - Review.reviews.wifrp_review - INFO - Applying NBR Overall Flag exclusion...
2025-12-16 15:19:46,601 - Review.reviews.wifrp_review - INFO - NBR Overall Flag exclusions: 1
2025-12-16 15:19:46,601 - Review.reviews.wifrp_review - INFO - Applying controversial weapons exclusions...
2025-12-16 15:19:46,602 - Review.reviews.wifrp_review - INFO - BiologicalWeapons exclusions: 0
2025-12-16 15:19:46,603 - Review.reviews.wifrp_review - INFO - ChemicalWeapons exclusions: 0
2025-12-16 15:19:46,604 - Review.reviews.wifrp_review - INFO - NuclearWeapons exclusions: 35
2025-12-16 15:19:46,604 - Review.reviews.wifrp_review - INFO - NuclearWeaponsNonNPT exclusions: 0
2025-12-16 15:19:46,605 - Review.reviews.wifrp_review - INFO - ClusterMunitions exclusions: 5
2025-12-16 15:19:46,606 - Review.reviews.wifrp_review - INFO - DepletedUranium exclusions: 7
2025-12-16 15:19:46,607 - Review.reviews.wifrp_review - INFO - APMines exclusions: 4
2025-12-16 15:19:46,608 - Review.reviews.wifrp_review - INFO - WhitePhosphorus exclusions: 7
2025-12-16 15:19:46,608 - Review.reviews.wifrp_review - INFO - Applying animal welfare exclusions...
2025-12-16 15:19:46,609 - Review.reviews.wifrp_review - INFO - Animal Welfare exclusions: 248
2025-12-16 15:19:46,610 - Review.reviews.wifrp_review - INFO - Animal Testing exclusions: 224
2025-12-16 15:19:46,610 - Review.reviews.wifrp_review - INFO - Applying energy screening exclusions...
2025-12-16 15:19:46,611 - Review.reviews.wifrp_review - INFO - Coal Mining exclusions: 91
2025-12-16 15:19:46,614 - Review.reviews.wifrp_review - INFO - Fossil Fuel exclusions: 308
2025-12-16 15:19:46,615 - Review.reviews.wifrp_review - INFO - Thermal Power exclusions: 112
2025-12-16 15:19:46,615 - Review.reviews.wifrp_review - INFO - Applying tobacco screening exclusions...
2025-12-16 15:19:46,617 - Review.reviews.wifrp_review - INFO - Tobacco Production exclusions: 0
2025-12-16 15:19:46,618 - Review.reviews.wifrp_review - INFO - Tobacco Distribution exclusions: 0
2025-12-16 15:19:46,618 - Review.reviews.wifrp_review - INFO - Applying layoff screening exclusion...
2025-12-16 15:19:46,620 - Review.reviews.wifrp_review - INFO - Layoff exclusions: 1219
2025-12-16 15:19:46,620 - Review.reviews.wifrp_review - INFO - Applying staff rating exclusion...
2025-12-16 15:19:46,621 - Review.reviews.wifrp_review - INFO - Companies with percentile < 20: 256
2025-12-16 15:19:46,622 - Review.reviews.wifrp_review - INFO - Companies near 20th percentile boundary: 33
2025-12-16 15:19:46,623 - Review.reviews.wifrp_review - INFO -   A2 MILK CO LTD: 20.83% - INCLUDED
2025-12-16 15:19:46,623 - Review.reviews.wifrp_review - INFO -   AGEAS: 19.23% - EXCLUDED
2025-12-16 15:19:46,623 - Review.reviews.wifrp_review - INFO -   AKZO NOBEL: 20.00% - INCLUDED
2025-12-16 15:19:46,624 - Review.reviews.wifrp_review - INFO -   AVANZA BANK HLDNG AB: 20.00% - INCLUDED
2025-12-16 15:19:46,624 - Review.reviews.wifrp_review - INFO -   BECHTLE AG: 20.00% - INCLUDED
2025-12-16 15:19:46,624 - Review.reviews.wifrp_review - INFO -   BROOKFIELD CORP: 19.35% - EXCLUDED
2025-12-16 15:19:46,624 - Review.reviews.wifrp_review - INFO -   BROTHER INDS LTD: 19.15% - EXCLUDED
2025-12-16 15:19:46,624 - Review.reviews.wifrp_review - INFO -   CANADIAN NATURAL RES: 20.59% - INCLUDED
2025-12-16 15:19:46,624 - Review.reviews.wifrp_review - INFO -   COMFORT SYSTEMS USA: 20.00% - INCLUDED
2025-12-16 15:19:46,625 - Review.reviews.wifrp_review - INFO -   DOLLAR GENERAL CORP.: 19.05% - EXCLUDED
2025-12-16 15:19:46,625 - Review.reviews.wifrp_review - INFO -   DSV A/S: 20.00% - INCLUDED
2025-12-16 15:19:46,625 - Review.reviews.wifrp_review - INFO -   E.ON SE: 20.83% - INCLUDED
2025-12-16 15:19:46,625 - Review.reviews.wifrp_review - INFO -   EBOS GROUP LTD: 20.69% - INCLUDED
2025-12-16 15:19:46,625 - Review.reviews.wifrp_review - INFO -   EXOR NV: 20.00% - INCLUDED
2025-12-16 15:19:46,626 - Review.reviews.wifrp_review - INFO -   FAIR ISAAC CORP.: 19.23% - EXCLUDED
2025-12-16 15:19:46,626 - Review.reviews.wifrp_review - INFO -   FORTINET INC.: 19.75% - EXCLUDED
2025-12-16 15:19:46,626 - Review.reviews.wifrp_review - INFO -   FUJI MEDIA HOLDINGS: 20.00% - INCLUDED
2025-12-16 15:19:46,626 - Review.reviews.wifrp_review - INFO -   GILEAD SCIENCES INC.: 20.83% - INCLUDED
2025-12-16 15:19:46,626 - Review.reviews.wifrp_review - INFO -   HIKARI TSUSHIN: 20.00% - INCLUDED
2025-12-16 15:19:46,626 - Review.reviews.wifrp_review - INFO -   HIROSE ELECTRIC: 19.15% - EXCLUDED
2025-12-16 15:19:46,626 - Review.reviews.wifrp_review - INFO -   IMI PLC: 20.00% - INCLUDED
2025-12-16 15:19:46,626 - Review.reviews.wifrp_review - INFO -   INTL CONS AIRLINES: 20.00% - INCLUDED
2025-12-16 15:19:46,626 - Review.reviews.wifrp_review - INFO -   JGC HOLDINGS COR: 19.05% - EXCLUDED
2025-12-16 15:19:46,626 - Review.reviews.wifrp_review - INFO -   KINTETSU GROUP H: 19.10% - EXCLUDED
2025-12-16 15:19:46,626 - Review.reviews.wifrp_review - INFO -   LINDE PLC: 20.00% - INCLUDED
2025-12-16 15:19:46,626 - Review.reviews.wifrp_review - INFO -   MONSTER BEVERAGE: 20.00% - INCLUDED
2025-12-16 15:19:46,626 - Review.reviews.wifrp_review - INFO -   NITORI HOLDINGS: 20.00% - INCLUDED
2025-12-16 15:19:46,626 - Review.reviews.wifrp_review - INFO -   POWER CORP CANADA: 20.83% - INCLUDED
2025-12-16 15:19:46,626 - Review.reviews.wifrp_review - INFO -   SHIMANO INC: 19.23% - EXCLUDED
2025-12-16 15:19:46,626 - Review.reviews.wifrp_review - INFO -   SUGI HD: 20.00% - INCLUDED
2025-12-16 15:19:46,626 - Review.reviews.wifrp_review - INFO -   SUN HUNG KAI PROPERT: 19.57% - EXCLUDED
2025-12-16 15:19:46,630 - Review.reviews.wifrp_review - INFO -   W.W. GRAINGER INC.: 20.51% - INCLUDED
2025-12-16 15:19:46,630 - Review.reviews.wifrp_review - INFO -   WIENERBERGER AG: 20.00% - INCLUDED
2025-12-16 15:19:46,631 - Review.reviews.wifrp_review - INFO - Staff Rating exclusions: 256
2025-12-16 15:19:46,670 - Review.reviews.wifrp_review - INFO - Companies remaining after exclusions: 92
2025-12-16 15:19:46,670 - Review.reviews.wifrp_review - INFO - Calculating FFMC for ranking...
2025-12-16 15:19:46,670 - Review.reviews.wifrp_review - INFO - Selecting top 40 companies by FFMC...
2025-12-16 15:19:46,670 - Review.reviews.wifrp_review - INFO - Applying 10% capping using most recent pricing data...
2025-12-16 15:19:46,670 - utils.capping_proportional - INFO - Starting proportional capping with max weight: 10.0%
2025-12-16 15:19:46,670 - utils.capping_proportional - INFO - Capping procedure converged after 1 iterations
2025-12-16 15:19:46,680 - utils.capping_proportional - INFO - Capping Summary:
2025-12-16 15:19:46,680 - utils.capping_proportional - INFO -   Total companies: 40
2025-12-16 15:19:46,680 - utils.capping_proportional - INFO -   Companies capped: 2
2025-12-16 15:19:46,681 - utils.capping_proportional - INFO -   Weight sum after capping: 1.000000
2025-12-16 15:19:46,681 - utils.capping_proportional - INFO -   Max weight after capping: 0.100000
2025-12-16 15:19:46,682 - Review.reviews.wifrp_review - INFO - Total weight after capping: 1.000000
2025-12-16 15:19:46,682 - Review.reviews.wifrp_review - INFO - Max weight after capping: 0.100000
2025-12-16 15:19:46,683 - Review.reviews.wifrp_review - INFO - Companies capped: 2
2025-12-16 15:19:46,687 - Review.reviews.wifrp_review - INFO - Saving WIFRP output to: C:\Users\CSonneveld\OneDrive - Euronext\Documents\Projects\GUI + Reviews\output\WIFRP_df_20251216_151946.xlsx
2025-12-16 15:19:48,407 - werkzeug - INFO - 127.0.0.1 - - [16/Dec/2025 15:19:48] "GET /task-status/2109eea1-d083-4c6c-9911-c0e2b89fda78 HTTP/1.1" 200 -
2025-12-16 15:25:39,939 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\OneDrive - Euronext\\Documents\\Projects\\GUI + Reviews\\Review\\reviews\\wifrp_review.py', reloading
2025-12-16 15:25:39,939 - werkzeug - INFO -  * Detected change in 'C:\\Users\\CSonneveld\\OneDrive - Euronext\\Documents\\Projects\\GUI + Reviews\\Review\\reviews\\wifrp_review.py', reloading
